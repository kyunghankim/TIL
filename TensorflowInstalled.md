```python
import os
import tensorflow as tf
import pandas as pd
import keras
import numpy as np
#from keras.layers import Embedding
from keras.models import Sequential
from keras.layers import Dense
from keras.layers import LSTM
from sklearn.preprocessing import MinMaxScaler
import matplotlib.pyplot as plt
import math
from sklearn.metrics import mean_squared_error
samsung=pd.read_excel('samsung.xlsx',header = 0)  # 파일 읽기(yahoo데이터)
samsung.columns=['date','open','low','high','close','volume','adj.close'] #열 이름
ss_close=samsung['close']  #종가만 뽑기
type(ss_close)
ss_nparr=ss_close.values[::1] #종가를 np array로
```

    Using TensorFlow backend.
    


```python
samsung.columns=['date','open','low','high','close','volume','adj.close'] #열 이름
```


```python
samsung
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>low</th>
      <th>high</th>
      <th>close</th>
      <th>volume</th>
      <th>adj.close</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2000-01-05</td>
      <td>6060</td>
      <td>5520</td>
      <td>5800</td>
      <td>5580</td>
      <td>74680000</td>
      <td>0.082740</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2000-01-06</td>
      <td>5780</td>
      <td>5580</td>
      <td>5750</td>
      <td>5620</td>
      <td>54390000</td>
      <td>0.083333</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2000-01-07</td>
      <td>5670</td>
      <td>5360</td>
      <td>5560</td>
      <td>5540</td>
      <td>40305000</td>
      <td>0.082147</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2000-01-10</td>
      <td>5770</td>
      <td>5580</td>
      <td>5600</td>
      <td>5770</td>
      <td>46880000</td>
      <td>0.085558</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2000-01-11</td>
      <td>6100</td>
      <td>5770</td>
      <td>5820</td>
      <td>5770</td>
      <td>59745000</td>
      <td>0.085558</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>5016</td>
      <td>2019-12-24</td>
      <td>55700</td>
      <td>54800</td>
      <td>55600</td>
      <td>55000</td>
      <td>11868463</td>
      <td>55000.000000</td>
    </tr>
    <tr>
      <td>5017</td>
      <td>2019-12-26</td>
      <td>55400</td>
      <td>54400</td>
      <td>54700</td>
      <td>55400</td>
      <td>9645034</td>
      <td>55400.000000</td>
    </tr>
    <tr>
      <td>5018</td>
      <td>2019-12-27</td>
      <td>56900</td>
      <td>55500</td>
      <td>55700</td>
      <td>56500</td>
      <td>12313056</td>
      <td>56500.000000</td>
    </tr>
    <tr>
      <td>5019</td>
      <td>2019-12-30</td>
      <td>56600</td>
      <td>55700</td>
      <td>56200</td>
      <td>55800</td>
      <td>8356767</td>
      <td>55800.000000</td>
    </tr>
    <tr>
      <td>5020</td>
      <td>2020-01-02</td>
      <td>56000</td>
      <td>55000</td>
      <td>55500</td>
      <td>55200</td>
      <td>12993228</td>
      <td>55200.000000</td>
    </tr>
  </tbody>
</table>
<p>5021 rows × 7 columns</p>
</div>




```python
dailyGap=samsung['high']-samsung['low']
plt.plot(dailyGap)
```




    [<matplotlib.lines.Line2D at 0x23593c454c8>]




![png](output_3_1.png)



```python

```


```python
samsung.columns=['date','open','high','low','close','volume','adj.close'] #열 이름
```


```python
samsung
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>date</th>
      <th>open</th>
      <th>high</th>
      <th>low</th>
      <th>close</th>
      <th>volume</th>
      <th>adj.close</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2000-01-05</td>
      <td>6060</td>
      <td>5520</td>
      <td>5800</td>
      <td>5580</td>
      <td>74680000</td>
      <td>0.082740</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2000-01-06</td>
      <td>5780</td>
      <td>5580</td>
      <td>5750</td>
      <td>5620</td>
      <td>54390000</td>
      <td>0.083333</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2000-01-07</td>
      <td>5670</td>
      <td>5360</td>
      <td>5560</td>
      <td>5540</td>
      <td>40305000</td>
      <td>0.082147</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2000-01-10</td>
      <td>5770</td>
      <td>5580</td>
      <td>5600</td>
      <td>5770</td>
      <td>46880000</td>
      <td>0.085558</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2000-01-11</td>
      <td>6100</td>
      <td>5770</td>
      <td>5820</td>
      <td>5770</td>
      <td>59745000</td>
      <td>0.085558</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>5016</td>
      <td>2019-12-24</td>
      <td>55700</td>
      <td>54800</td>
      <td>55600</td>
      <td>55000</td>
      <td>11868463</td>
      <td>55000.000000</td>
    </tr>
    <tr>
      <td>5017</td>
      <td>2019-12-26</td>
      <td>55400</td>
      <td>54400</td>
      <td>54700</td>
      <td>55400</td>
      <td>9645034</td>
      <td>55400.000000</td>
    </tr>
    <tr>
      <td>5018</td>
      <td>2019-12-27</td>
      <td>56900</td>
      <td>55500</td>
      <td>55700</td>
      <td>56500</td>
      <td>12313056</td>
      <td>56500.000000</td>
    </tr>
    <tr>
      <td>5019</td>
      <td>2019-12-30</td>
      <td>56600</td>
      <td>55700</td>
      <td>56200</td>
      <td>55800</td>
      <td>8356767</td>
      <td>55800.000000</td>
    </tr>
    <tr>
      <td>5020</td>
      <td>2020-01-02</td>
      <td>56000</td>
      <td>55000</td>
      <td>55500</td>
      <td>55200</td>
      <td>12993228</td>
      <td>55200.000000</td>
    </tr>
  </tbody>
</table>
<p>5021 rows × 7 columns</p>
</div>




```python
ss_close=samsung['close']  #종가만 뽑기
type(ss_close)
```




    pandas.core.series.Series




```python
ss_nparr=ss_close.values[::1] #종가를 np array로
ss_nparr=ss_nparr.astype('float32')
print(ss_nparr)
```

    [ 5580.  5620.  5540. ... 56500. 55800. 55200.]
    


```python
look_back=1
def create_dataset(dataset,look_back=1):
    dataX, dataY=[], []
    for i in range(len(dataset)-look_back-1):
        a = dataset[i:(i + look_back)]
        dataX.append(a)
        dataY.append(dataset[i+look_back])
    return np.array(dataX),np.array(dataY)    #데이터셋으로 바꾸기
```


```python
new_ssarr=ss_nparr.reshape(-1,1)
new_ssarr  # fit을 위한 reshape
plt.grid(True)
plt.plot(new_ssarr)
```




    [<matplotlib.lines.Line2D at 0x23593888448>]




![png](output_10_1.png)



```python
scaler=MinMaxScaler(feature_range=(0,1))
ss_trsf=scaler.fit_transform(new_ssarr)
```


```python
train_size=int(len(ss_trsf)*0.9)
test_size=len(ss_trsf) - train_size   #train size, test size (90%사용)
```


```python
train, test=ss_trsf[0:train_size], ss_trsf[train_size:len(ss_trsf),:]
print([train,test])   #데이터의 train size, test size만큼 뽑아서 test,train만듬
```

    [array([[0.05230317],
           [0.05303726],
           [0.0515691 ],
           ...,
           [0.8829143 ],
           [0.8920903 ],
           [0.89062214]], dtype=float32), array([[0.8678657 ],
           [0.88107914],
           [0.90420264],
           [0.9001652 ],
           [0.9060378 ],
           [0.8917233 ],
           [0.88695174],
           [0.87887686],
           [0.88952106],
           [0.89612776],
           [0.8517159 ],
           [0.8619931 ],
           [0.8344651 ],
           [0.85575336],
           [0.8851166 ],
           [0.8972289 ],
           [0.8873188 ],
           [0.90640485],
           [0.9045697 ],
           [0.8748394 ],
           [0.84621036],
           [0.8351991 ],
           [0.8344651 ],
           [0.84070474],
           [0.86749864],
           [0.8605249 ],
           [0.86566347],
           [0.8550193 ],
           [0.8351991 ],
           [0.85208297],
           [0.8553863 ],
           [0.87227017],
           [0.8818132 ],
           [0.8898881 ],
           [0.86382824],
           [0.86566347],
           [0.8641953 ],
           [0.8252891 ],
           [0.8293265 ],
           [0.8201505 ],
           [0.7904203 ],
           [0.7940907 ],
           [0.7702331 ],
           [0.7889521 ],
           [0.82235277],
           [0.84914666],
           [0.83776844],
           [0.81978345],
           [0.81758124],
           [0.8080382 ],
           [0.8164801 ],
           [0.8194164 ],
           [0.8194164 ],
           [0.8135438 ],
           [0.79445773],
           [0.7794091 ],
           [0.8128097 ],
           [0.8421729 ],
           [0.85281706],
           [0.8627271 ],
           [0.8627271 ],
           [0.8979629 ],
           [0.89979815],
           [0.8957607 ],
           [0.8884199 ],
           [0.88107914],
           [0.88952106],
           [0.88695174],
           [0.9001652 ],
           [0.8623601 ],
           [0.8726372 ],
           [0.8671316 ],
           [0.84364104],
           [0.84988075],
           [0.8531841 ],
           [0.84070474],
           [0.8329969 ],
           [0.81097454],
           [0.84437513],
           [0.8381355 ],
           [0.85281706],
           [0.8469444 ],
           [0.8465774 ],
           [0.84914666],
           [0.86382824],
           [0.87373835],
           [0.8671316 ],
           [0.89245737],
           [0.9185172 ],
           [0.8972289 ],
           [0.9023674 ],
           [0.87594056],
           [0.8748394 ],
           [0.9067719 ],
           [0.9225546 ],
           [0.9225546 ],
           [0.9225546 ],
           [0.9225546 ],
           [0.9023674 ],
           [0.9152138 ],
           [0.88401544],
           [0.89686185],
           [0.8913562 ],
           [0.86933386],
           [0.85281706],
           [0.86474586],
           [0.85648745],
           [0.8583227 ],
           [0.86749864],
           [0.90053225],
           [0.89319146],
           [0.91704905],
           [0.9097082 ],
           [0.8913562 ],
           [0.8583227 ],
           [0.88034505],
           [0.8913562 ],
           [0.88768584],
           [0.8913562 ],
           [0.8785098 ],
           [0.86107546],
           [0.86566347],
           [0.85648745],
           [0.8344651 ],
           [0.82437146],
           [0.8051019 ],
           [0.81244266],
           [0.81244266],
           [0.8133603 ],
           [0.81703067],
           [0.8060195 ],
           [0.81244266],
           [0.8298771 ],
           [0.80877227],
           [0.8060195 ],
           [0.7858323 ],
           [0.79684347],
           [0.7986787 ],
           [0.7931731 ],
           [0.7739035 ],
           [0.7867499 ],
           [0.7995963 ],
           [0.7940907 ],
           [0.7849147 ],
           [0.8032667 ],
           [0.7950083 ],
           [0.7913379 ],
           [0.80418426],
           [0.8106075 ],
           [0.82070106],
           [0.8032667 ],
           [0.79684347],
           [0.79684347],
           [0.8106075 ],
           [0.8106075 ],
           [0.8032667 ],
           [0.7986787 ],
           [0.80418426],
           [0.7858323 ],
           [0.7895027 ],
           [0.7904203 ],
           [0.8069371 ],
           [0.80877227],
           [0.8106075 ],
           [0.7830795 ],
           [0.77665627],
           [0.7784915 ],
           [0.7619747 ],
           [0.7592219 ],
           [0.7546339 ],
           [0.7720683 ],
           [0.79592586],
           [0.7977611 ],
           [0.79684347],
           [0.7995963 ],
           [0.80418426],
           [0.80877227],
           [0.82437146],
           [0.83905303],
           [0.82070106],
           [0.82437146],
           [0.8051019 ],
           [0.79592586],
           [0.7739035 ],
           [0.7849147 ],
           [0.77665627],
           [0.7674803 ],
           [0.7583043 ],
           [0.7913379 ],
           [0.7784915 ],
           [0.7849147 ],
           [0.79684347],
           [0.81703067],
           [0.81978345],
           [0.8216187 ],
           [0.8023491 ],
           [0.80051386],
           [0.78858507],
           [0.7702331 ],
           [0.7702331 ],
           [0.7748211 ],
           [0.7812443 ],
           [0.7408699 ],
           [0.7573867 ],
           [0.7537163 ],
           [0.7500459 ],
           [0.7601395 ],
           [0.7583043 ],
           [0.7555515 ],
           [0.7491283 ],
           [0.7399523 ],
           [0.7307763 ],
           [0.7023307 ],
           [0.7023307 ],
           [0.7096715 ],
           [0.7271059 ],
           [0.7280235 ],
           [0.7234355 ],
           [0.7601395 ],
           [0.7537163 ],
           [0.7527987 ],
           [0.7573867 ],
           [0.7583043 ],
           [0.7628923 ],
           [0.7794091 ],
           [0.7665627 ],
           [0.7592219 ],
           [0.7573867 ],
           [0.7509635 ],
           [0.7353643 ],
           [0.7225179 ],
           [0.72894114],
           [0.7280235 ],
           [0.7316939 ],
           [0.7399523 ],
           [0.7417875 ],
           [0.7417875 ],
           [0.7179299 ],
           [0.7436227 ],
           [0.7234355 ],
           [0.7105891 ],
           [0.69315475],
           [0.70141315],
           [0.68764913],
           [0.68856674],
           [0.69223714],
           [0.68397874],
           [0.66470915],
           [0.66837955],
           [0.66379154],
           [0.66746193],
           [0.6592035 ],
           [0.6592035 ],
           [0.66195637],
           [0.65369797],
           [0.65186274],
           [0.66012114],
           [0.66103876],
           [0.63993394],
           [0.63718116],
           [0.66103876],
           [0.64910996],
           [0.67663795],
           [0.68030834],
           [0.69315475],
           [0.68489635],
           [0.70416594],
           [0.7105891 ],
           [0.7197651 ],
           [0.7261883 ],
           [0.7344467 ],
           [0.7234355 ],
           [0.72068274],
           [0.7399523 ],
           [0.7711507 ],
           [0.77665627],
           [0.7849147 ],
           [0.8014315 ],
           [0.79684347],
           [0.80051386],
           [0.7977611 ],
           [0.7720683 ],
           [0.7757387 ],
           [0.7950083 ],
           [0.7977611 ],
           [0.8216187 ],
           [0.7950083 ],
           [0.7977611 ],
           [0.7931731 ],
           [0.8106075 ],
           [0.81152505],
           [0.8151955 ],
           [0.8188659 ],
           [0.80785465],
           [0.80785465],
           [0.7775739 ],
           [0.7729859 ],
           [0.7619747 ],
           [0.7573867 ],
           [0.7656451 ],
           [0.7537163 ],
           [0.7509635 ],
           [0.7693155 ],
           [0.7546339 ],
           [0.7546339 ],
           [0.7610571 ],
           [0.7518811 ],
           [0.7555515 ],
           [0.7583043 ],
           [0.7913379 ],
           [0.80418426],
           [0.7849147 ],
           [0.78032666],
           [0.7821619 ],
           [0.7729859 ],
           [0.7693155 ],
           [0.77665627],
           [0.7895027 ],
           [0.8051019 ],
           [0.81152505],
           [0.8096899 ],
           [0.8060195 ],
           [0.8060195 ],
           [0.8069371 ],
           [0.7986787 ],
           [0.8096899 ],
           [0.8133603 ],
           [0.81703067],
           [0.8133603 ],
           [0.7867499 ],
           [0.7812443 ],
           [0.7821619 ],
           [0.7794091 ],
           [0.7711507 ],
           [0.7693155 ],
           [0.7729859 ],
           [0.79684347],
           [0.7913379 ],
           [0.79225546],
           [0.7812443 ],
           [0.7729859 ],
           [0.7619747 ],
           [0.72894114],
           [0.7371995 ],
           [0.73261154],
           [0.73261154],
           [0.7307763 ],
           [0.71242434],
           [0.7060011 ],
           [0.72068274],
           [0.7417875 ],
           [0.7482107 ],
           [0.7546339 ],
           [0.7335291 ],
           [0.73261154],
           [0.7307763 ],
           [0.71701235],
           [0.7307763 ],
           [0.7298587 ],
           [0.7537163 ],
           [0.7472931 ],
           [0.7555515 ],
           [0.7610571 ],
           [0.7720683 ],
           [0.7729859 ],
           [0.76839787],
           [0.7527987 ],
           [0.7573867 ],
           [0.7555515 ],
           [0.7638099 ],
           [0.7821619 ],
           [0.7849147 ],
           [0.78858507],
           [0.7849147 ],
           [0.7867499 ],
           [0.78858507],
           [0.8032667 ],
           [0.81244266],
           [0.8051019 ],
           [0.7986787 ],
           [0.7830795 ],
           [0.7940907 ],
           [0.7876675 ],
           [0.7647275 ],
           [0.7775739 ],
           [0.7858323 ],
           [0.7977611 ],
           [0.7995963 ],
           [0.8023491 ],
           [0.8096899 ],
           [0.7950083 ],
           [0.79592586],
           [0.80877227],
           [0.81611305],
           [0.8179483 ],
           [0.8014315 ],
           [0.81611305],
           [0.8151955 ],
           [0.79592586],
           [0.80418426],
           [0.7821619 ],
           [0.7794091 ],
           [0.7748211 ],
           [0.75646913],
           [0.7482107 ],
           [0.7427051 ],
           [0.73261154],
           [0.7417875 ],
           [0.7518811 ],
           [0.7390347 ],
           [0.7518811 ],
           [0.7555515 ],
           [0.7500459 ],
           [0.7656451 ],
           [0.7665627 ],
           [0.7583043 ],
           [0.75646913],
           [0.7500459 ],
           [0.7583043 ],
           [0.7601395 ],
           [0.7463755 ],
           [0.7573867 ],
           [0.7537163 ],
           [0.7436227 ],
           [0.7592219 ],
           [0.78858507],
           [0.7995963 ],
           [0.8106075 ],
           [0.81244266],
           [0.8151955 ],
           [0.8142779 ],
           [0.8106075 ],
           [0.8252891 ],
           [0.85189945],
           [0.85281706],
           [0.8546523 ],
           [0.8583227 ],
           [0.84731144],
           [0.85281706],
           [0.8381355 ],
           [0.8500643 ],
           [0.8463939 ],
           [0.82345384],
           [0.8307947 ],
           [0.8262067 ],
           [0.84731144],
           [0.84088826],
           [0.85189945],
           [0.86749864],
           [0.86933386],
           [0.88034505],
           [0.87667465],
           [0.86566347],
           [0.87300426],
           [0.88952106],
           [0.88952106],
           [0.88034505],
           [0.88401544],
           [0.8913562 ],
           [0.88768584],
           [0.8748394 ],
           [0.8748394 ],
           [0.88952106],
           [0.9097082 ],
           [0.91704905],
           [0.92806023],
           [0.92071944],
           [0.9060378 ],
           [0.89686185],
           [0.9152138 ],
           [0.91337866],
           [0.935401  ],
           [0.9317306 ],
           [0.9317306 ],
           [0.90420264],
           [0.88585067],
           [0.89686185],
           [0.90053225],
           [0.90053225],
           [0.90787303],
           [0.8913562 ],
           [0.87300426],
           [0.8748394 ],
           [0.86566347],
           [0.85740507],
           [0.8583227 ],
           [0.8748394 ],
           [0.88952106],
           [0.8950266 ],
           [0.9023674 ],
           [0.92806023],
           [0.953753  ],
           [0.953753  ],
           [0.99045694],
           [0.98311615],
           [0.9776106 ],
           [0.9776106 ],
           [0.9684346 ],
           [0.95925856],
           [0.96659935],
           [0.9867866 ],
           [0.97394025],
           [0.962929  ]], dtype=float32)]
    


```python
trainX , trainY= create_dataset(train, look_back)
testX, testY= create_dataset(test, look_back)
print(trainX)
print("#"*30)
print(trainY)
```

    [[[0.05230317]]
    
     [[0.05303726]]
    
     [[0.0515691 ]]
    
     ...
    
     [[0.9152138 ]]
    
     [[0.8821802 ]]
    
     [[0.8829143 ]]]
    ##############################
    [[0.05303726]
     [0.0515691 ]
     [0.05579005]
     ...
     [0.8821802 ]
     [0.8829143 ]
     [0.8920903 ]]
    


```python
trainX=np.reshape(trainX,(trainX.shape[0],1,trainX.shape[1]))
testX=np.reshape(testX,(testX.shape[0],1,testX.shape[1]))
#[sample,feature]에서 [samples,time steps,features]로 바꿈
```


```python
# LSTM만들기
model=Sequential()
model.add(LSTM(4,input_shape=(1,look_back)))
model.add(Dense(1))
model.compile(loss='mean_squared_error',optimizer='adam')
model.fit(trainX,trainY,epochs=100,batch_size=1, verbose=2)
```

    Epoch 1/100
     - 5s - loss: 0.0123
    Epoch 2/100
     - 5s - loss: 7.2462e-05
    Epoch 3/100
     - 5s - loss: 7.2470e-05
    Epoch 4/100
     - 5s - loss: 7.1865e-05
    Epoch 5/100
     - 5s - loss: 6.7762e-05
    Epoch 6/100
     - 5s - loss: 6.6047e-05
    Epoch 7/100
     - 5s - loss: 6.6504e-05
    Epoch 8/100
     - 4s - loss: 6.5196e-05
    Epoch 9/100
     - 4s - loss: 6.3220e-05
    Epoch 10/100
     - 4s - loss: 6.3732e-05
    Epoch 11/100
     - 4s - loss: 6.2345e-05
    Epoch 12/100
     - 5s - loss: 5.9927e-05
    Epoch 13/100
     - 5s - loss: 6.0039e-05
    Epoch 14/100
     - 4s - loss: 6.0205e-05
    Epoch 15/100
     - 4s - loss: 5.9104e-05
    Epoch 16/100
     - 4s - loss: 5.7847e-05
    Epoch 17/100
     - 5s - loss: 5.7325e-05
    Epoch 18/100
     - 5s - loss: 5.6215e-05
    Epoch 19/100
     - 4s - loss: 5.3930e-05
    Epoch 20/100
     - 4s - loss: 5.4516e-05
    Epoch 21/100
     - 4s - loss: 5.2822e-05
    Epoch 22/100
     - 5s - loss: 5.0795e-05
    Epoch 23/100
     - 4s - loss: 5.0788e-05
    Epoch 24/100
     - 5s - loss: 5.2492e-05
    Epoch 25/100
     - 4s - loss: 5.2224e-05
    Epoch 26/100
     - 4s - loss: 5.1661e-05
    Epoch 27/100
     - 4s - loss: 5.0752e-05
    Epoch 28/100
     - 4s - loss: 5.1887e-05
    Epoch 29/100
     - 4s - loss: 5.1052e-05
    Epoch 30/100
     - 4s - loss: 5.0377e-05
    Epoch 31/100
     - 4s - loss: 5.0338e-05
    Epoch 32/100
     - 4s - loss: 5.1621e-05
    Epoch 33/100
     - 4s - loss: 5.0398e-05
    Epoch 34/100
     - 5s - loss: 5.1326e-05
    Epoch 35/100
     - 4s - loss: 5.0765e-05
    Epoch 36/100
     - 5s - loss: 5.0041e-05
    Epoch 37/100
     - 4s - loss: 5.0406e-05
    Epoch 38/100
     - 4s - loss: 5.0001e-05
    Epoch 39/100
     - 4s - loss: 5.1104e-05
    Epoch 40/100
     - 4s - loss: 5.0667e-05
    Epoch 41/100
     - 4s - loss: 5.0910e-05
    Epoch 42/100
     - 4s - loss: 5.1407e-05
    Epoch 43/100
     - 4s - loss: 5.0830e-05
    Epoch 44/100
     - 4s - loss: 5.2005e-05
    Epoch 45/100
     - 4s - loss: 5.0731e-05
    Epoch 46/100
     - 4s - loss: 4.9523e-05
    Epoch 47/100
     - 4s - loss: 5.0282e-05
    Epoch 48/100
     - 4s - loss: 5.1098e-05
    Epoch 49/100
     - 4s - loss: 5.1274e-05
    Epoch 50/100
     - 4s - loss: 5.0760e-05
    Epoch 51/100
     - 4s - loss: 5.0049e-05
    Epoch 52/100
     - 4s - loss: 5.0715e-05
    Epoch 53/100
     - 4s - loss: 5.0629e-05
    Epoch 54/100
     - 4s - loss: 4.9590e-05
    Epoch 55/100
     - 4s - loss: 4.9912e-05
    Epoch 56/100
     - 4s - loss: 5.0461e-05
    Epoch 57/100
     - 4s - loss: 4.9570e-05
    Epoch 58/100
     - 4s - loss: 4.9028e-05
    Epoch 59/100
     - 4s - loss: 4.9796e-05
    Epoch 60/100
     - 4s - loss: 5.0198e-05
    Epoch 61/100
     - 4s - loss: 4.8605e-05
    Epoch 62/100
     - 4s - loss: 5.0663e-05
    Epoch 63/100
     - 4s - loss: 5.0006e-05
    Epoch 64/100
     - 4s - loss: 4.9616e-05
    Epoch 65/100
     - 4s - loss: 5.0247e-05
    Epoch 66/100
     - 4s - loss: 5.0583e-05
    Epoch 67/100
     - 4s - loss: 5.0301e-05
    Epoch 68/100
     - 4s - loss: 5.0185e-05
    Epoch 69/100
     - 4s - loss: 5.0787e-05
    Epoch 70/100
     - 4s - loss: 4.9192e-05
    Epoch 71/100
     - 4s - loss: 4.9534e-05
    Epoch 72/100
     - 4s - loss: 5.0453e-05
    Epoch 73/100
     - 4s - loss: 5.0152e-05
    Epoch 74/100
     - 4s - loss: 5.0736e-05
    Epoch 75/100
     - 4s - loss: 4.9733e-05
    Epoch 76/100
     - 4s - loss: 5.1088e-05
    Epoch 77/100
     - 4s - loss: 5.0432e-05
    Epoch 78/100
     - 4s - loss: 5.0696e-05
    Epoch 79/100
     - 4s - loss: 4.9708e-05
    Epoch 80/100
     - 4s - loss: 5.0409e-05
    Epoch 81/100
     - 4s - loss: 5.0352e-05
    Epoch 82/100
     - 4s - loss: 4.9091e-05
    Epoch 83/100
     - 4s - loss: 4.9346e-05
    Epoch 84/100
     - 4s - loss: 5.0099e-05
    Epoch 85/100
     - 5s - loss: 4.8851e-05
    Epoch 86/100
     - 5s - loss: 4.9097e-05
    Epoch 87/100
     - 4s - loss: 4.9746e-05
    Epoch 88/100
     - 5s - loss: 4.9235e-05
    Epoch 89/100
     - 5s - loss: 5.1550e-05
    Epoch 90/100
     - 5s - loss: 5.0767e-05
    Epoch 91/100
     - 5s - loss: 4.9073e-05
    Epoch 92/100
     - 5s - loss: 4.9430e-05
    Epoch 93/100
     - 4s - loss: 4.9789e-05
    Epoch 94/100
     - 4s - loss: 4.9356e-05
    Epoch 95/100
     - 4s - loss: 5.1254e-05
    Epoch 96/100
     - 4s - loss: 4.8636e-05
    Epoch 97/100
     - 4s - loss: 4.9257e-05
    Epoch 98/100
     - 4s - loss: 4.8994e-05
    Epoch 99/100
     - 4s - loss: 4.8541e-05
    Epoch 100/100
     - 5s - loss: 4.8128e-05
    




    <keras.callbacks.callbacks.History at 0x23594fac688>




```python
# 예측하기
testPredict=model.predict(testX)
testPredict=scaler.inverse_transform(testPredict)
testY=scaler.inverse_transform(testY)
testScore=math.sqrt(mean_squared_error(testY,testPredict))
print('Train Score: %.2f RMSE' % testScore)
```

    Train Score: 769.82 RMSE
    


```python
# 다음날 주가 예측하기
lastX = new_ssarr[-1]
lastX = np.reshape(lastX, (1, 1, 1))
lastY = model.predict(lastX)
lastY = scaler.inverse_transform(lastY)
# 데이터 입력 마지막 다음날 종가 예측
print('마지막날 종가 예측: %d' % lastY)  
```

    마지막날 종가 예측: 120771
    


```python
# 시각화~
plt.grid(True)
plt.plot(testY) #파란선
plt.plot(testPredict)
plt.show()
```


![png](output_19_0.png)



```python
#예측의 차이값
plt.title("Differece")
plt.grid(True)
#plt.figure(figsize=(100,50))
plt.plot(testPredict-testY)
```




    [<matplotlib.lines.Line2D at 0x2359c4a80c8>]




![png](output_20_1.png)



```python
plt.plot(testY)
```




    [<matplotlib.lines.Line2D at 0x235f9c1bdc8>]




![png](output_21_1.png)



```python
plt.plot(testPredict)
print(len(testPredict))
```

    501
    


![png](output_22_1.png)



```python
testrange=samsung[-501:]
plt.plot(testrange['close'])
```




    [<matplotlib.lines.Line2D at 0x23593a5b0c8>]




![png](output_23_1.png)



```python
testclose=np.array(samsung['close'][-501:])
```


```python
testPredict
```




    array([[50174.676],
           [50873.09 ],
           [52087.668],
           [51876.32 ],
           [52183.625],
           [51433.42 ],
           [51182.5  ],
           [50756.9  ],
           [51317.664],
           [51664.668],
           [49316.977],
           [49863.297],
           [48396.1  ],
           [49531.81 ],
           [51085.875],
           [51722.42 ],
           [51201.816],
           [52202.812],
           [52106.863],
           [50543.67 ],
           [49023.598],
           [48435.375],
           [48396.1  ],
           [48729.723],
           [50155.227],
           [49785.36 ],
           [50057.973],
           [49492.77 ],
           [48435.375],
           [49336.52 ],
           [49512.293],
           [50407.824],
           [50911.8  ],
           [51336.96 ],
           [49960.66 ],
           [50057.973],
           [49980.137],
           [47904.402],
           [48120.906],
           [47628.504],
           [46025.043],
           [46223.645],
           [44929.863],
           [45945.562],
           [47746.793],
           [49180.125],
           [48572.805],
           [47608.785],
           [47490.414],
           [46976.688],
           [47431.207],
           [47589.06 ],
           [47589.06 ],
           [47273.223],
           [46243.49 ],
           [45428.28 ],
           [47233.707],
           [48808.14 ],
           [49375.594],
           [49902.246],
           [49902.246],
           [51760.91 ],
           [51857.09 ],
           [51645.41 ],
           [51259.746],
           [50873.09 ],
           [51317.664],
           [51182.5  ],
           [51876.32 ],
           [49882.77 ],
           [50427.24 ],
           [50135.785],
           [48886.51 ],
           [49219.234],
           [49395.133],
           [48729.723],
           [48317.52 ],
           [47134.895],
           [48925.69 ],
           [48592.42 ],
           [49375.594],
           [49062.74 ],
           [49043.168],
           [49180.125],
           [49960.66 ],
           [50485.465],
           [50135.785],
           [51471.99 ],
           [52834.418],
           [51722.42 ],
           [51991.633],
           [50601.85 ],
           [50543.67 ],
           [52221.996],
           [53044.305],
           [53044.305],
           [53044.305],
           [53044.305],
           [51991.633],
           [52662.45 ],
           [51027.875],
           [51703.176],
           [51414.13 ],
           [50252.43 ],
           [49375.594],
           [50009.332],
           [49570.84 ],
           [49668.38 ],
           [50155.227],
           [51895.547],
           [51510.54 ],
           [52758.02 ],
           [52375.35 ],
           [51414.13 ],
           [49668.38 ],
           [50834.375],
           [51414.13 ],
           [51221.13 ],
           [51414.13 ],
           [50737.527],
           [49814.586],
           [50057.973],
           [49570.84 ],
           [48396.1  ],
           [47855.164],
           [46818.367],
           [47213.94 ],
           [47213.94 ],
           [47263.348],
           [47460.812],
           [46867.86 ],
           [47213.945],
           [48150.414],
           [47016.25 ],
           [46867.86 ],
           [45776.57 ],
           [46372.47 ],
           [46471.637],
           [46174.004],
           [45129.35 ],
           [45826.29 ],
           [46521.2  ],
           [46223.645],
           [45726.85 ],
           [46719.36 ],
           [46273.258],
           [46074.72 ],
           [46768.867],
           [47115.125],
           [47658.086],
           [46719.36 ],
           [46372.47 ],
           [46372.47 ],
           [47115.125],
           [47115.125],
           [46719.36 ],
           [46471.637],
           [46768.867],
           [45776.57 ],
           [45975.37 ],
           [46025.043],
           [46917.332],
           [47016.25 ],
           [47115.125],
           [45627.363],
           [45278.85 ],
           [45378.48 ],
           [44480.49 ],
           [44330.527],
           [44080.42 ],
           [45029.62 ],
           [46322.87 ],
           [46422.055],
           [46372.47 ],
           [46521.2  ],
           [46768.867],
           [47016.25 ],
           [47855.164],
           [48641.47 ],
           [47658.086],
           [47855.164],
           [46818.367],
           [46322.87 ],
           [45129.35 ],
           [45726.85 ],
           [45278.85 ],
           [44780.16 ],
           [44280.523],
           [46074.72 ],
           [45378.48 ],
           [45726.85 ],
           [46372.47 ],
           [47460.812],
           [47608.785],
           [47707.37 ],
           [46669.836],
           [46570.758],
           [45925.688],
           [44929.863],
           [44929.863],
           [45179.19 ],
           [45527.84 ],
           [43328.84 ],
           [44230.51 ],
           [44030.37 ],
           [43830.105],
           [44380.523],
           [44280.523],
           [44130.46 ],
           [43780.01 ],
           [43278.67 ],
           [42776.543],
           [41215.535],
           [41215.535],
           [41618.97 ],
           [42575.49 ],
           [42625.758],
           [42374.32 ],
           [44380.523],
           [44030.37 ],
           [43980.316],
           [44230.51 ],
           [44280.523],
           [44530.457],
           [45428.28 ],
           [44730.234],
           [44330.527],
           [44230.51 ],
           [43880.188],
           [43027.7  ],
           [42324.008],
           [42676.03 ],
           [42625.758],
           [42826.793],
           [43278.67 ],
           [43379.004],
           [43379.004],
           [42072.355],
           [43479.3  ],
           [42374.32 ],
           [41669.37 ],
           [40710.73 ],
           [41165.082],
           [40407.598],
           [40458.13 ],
           [40660.223],
           [40205.402],
           [39142.7  ],
           [39345.26 ],
           [39092.05 ],
           [39294.63 ],
           [38838.746],
           [38838.746],
           [38990.746],
           [38534.668],
           [38433.28 ],
           [38889.418],
           [38940.08 ],
           [37773.98 ],
           [37621.773],
           [38940.08 ],
           [38281.18 ],
           [39800.793],
           [40003.133],
           [40710.73 ],
           [40255.957],
           [41316.434],
           [41669.37 ],
           [42173.035],
           [42525.207],
           [42977.484],
           [42374.32 ],
           [42223.37 ],
           [43278.67 ],
           [44979.75 ],
           [45278.85 ],
           [45726.85 ],
           [46620.305],
           [46372.47 ],
           [46570.758],
           [46422.055],
           [45029.62 ],
           [45229.027],
           [46273.258],
           [46422.055],
           [47707.37 ],
           [46273.26 ],
           [46422.055],
           [46174.004],
           [47115.125],
           [47164.543],
           [47362.1  ],
           [47559.477],
           [46966.797],
           [46966.797],
           [45328.67 ],
           [45079.49 ],
           [44480.49 ],
           [44230.51 ],
           [44680.297],
           [44030.37 ],
           [43880.188],
           [44879.97 ],
           [44080.42 ],
           [44080.42 ],
           [44430.504],
           [43930.258],
           [44130.46 ],
           [44280.523],
           [46074.72 ],
           [46768.867],
           [45726.85 ],
           [45478.06 ],
           [45577.605],
           [45079.49 ],
           [44879.97 ],
           [45278.85 ],
           [45975.37 ],
           [46818.367],
           [47164.543],
           [47065.69 ],
           [46867.86 ],
           [46867.86 ],
           [46917.332],
           [46471.637],
           [47065.69 ],
           [47263.348],
           [47460.812],
           [47263.348],
           [45826.29 ],
           [45527.84 ],
           [45577.605],
           [45428.28 ],
           [44979.75 ],
           [44879.97 ],
           [45079.49 ],
           [46372.47 ],
           [46074.72 ],
           [46124.363],
           [45527.84 ],
           [45079.49 ],
           [44480.49 ],
           [42676.03 ],
           [43128.113],
           [42877.035],
           [42877.035],
           [42776.543],
           [41770.152],
           [41417.3  ],
           [42223.37 ],
           [43379.004],
           [43729.914],
           [44080.42 ],
           [42927.26 ],
           [42877.035],
           [42776.543],
           [42022.004],
           [42776.543],
           [42726.29 ],
           [44030.37 ],
           [43679.812],
           [44130.46 ],
           [44430.504],
           [45029.62 ],
           [45079.49 ],
           [44830.066],
           [43980.316],
           [44230.51 ],
           [44130.46 ],
           [44580.41 ],
           [45577.605],
           [45726.85 ],
           [45925.688],
           [45726.85 ],
           [45826.29 ],
           [45925.688],
           [46719.36 ],
           [47213.945],
           [46818.367],
           [46471.637],
           [45627.363],
           [46223.645],
           [45876.   ],
           [44630.363],
           [45328.67 ],
           [45776.57 ],
           [46422.055],
           [46521.2  ],
           [46669.836],
           [47065.69 ],
           [46273.258],
           [46322.87 ],
           [47016.25 ],
           [47411.465],
           [47510.15 ],
           [46620.305],
           [47411.465],
           [47362.1  ],
           [46322.87 ],
           [46768.867],
           [45577.605],
           [45428.28 ],
           [45179.19 ],
           [44180.49 ],
           [43729.914],
           [43429.152],
           [42877.035],
           [43379.004],
           [43930.258],
           [43228.492],
           [43930.258],
           [44130.46 ],
           [43830.105],
           [44680.297],
           [44730.234],
           [44280.523],
           [44180.49 ],
           [43830.105],
           [44280.523],
           [44380.523],
           [43629.7  ],
           [44230.51 ],
           [44030.37 ],
           [43479.3  ],
           [44330.527],
           [45925.688],
           [46521.2  ],
           [47115.125],
           [47213.945],
           [47362.1  ],
           [47312.73 ],
           [47115.125],
           [47904.402],
           [49326.75 ],
           [49375.594],
           [49473.25 ],
           [49668.38 ],
           [49082.312],
           [49375.594],
           [48592.42 ],
           [49229.016],
           [49033.387],
           [47805.91 ],
           [48199.574],
           [47953.633],
           [49082.312],
           [48739.535],
           [49326.746],
           [50155.227],
           [50252.43 ],
           [50834.375],
           [50640.63 ],
           [50057.973],
           [50446.65 ],
           [51317.664],
           [51317.664],
           [50834.375],
           [51027.875],
           [51414.13 ],
           [51221.13 ],
           [50543.67 ],
           [50543.67 ],
           [51317.664],
           [52375.35 ],
           [52758.02 ],
           [53329.98 ],
           [52948.94 ],
           [52183.625],
           [51703.176],
           [52662.45 ],
           [52566.82 ],
           [53709.91 ],
           [53520.082],
           [53520.082],
           [52087.668],
           [51124.535],
           [51703.176],
           [51895.547],
           [51895.55 ],
           [52279.52 ],
           [51414.13 ],
           [50446.65 ],
           [50543.67 ],
           [50057.973],
           [49619.617],
           [49668.38 ],
           [50543.67 ],
           [51317.664],
           [51606.887],
           [51991.633],
           [53329.98 ],
           [54654.758],
           [54654.758],
           [56522.137],
           [56151.12 ],
           [55872.047],
           [55872.047],
           [55405.367],
           [54936.793],
           [55311.797],
           [56336.797]], dtype=float32)




```python
testclose_rs=testclose.reshape(-1,1)
```


```python
plt.plot(testPredict-testclose_rs)
```




    [<matplotlib.lines.Line2D at 0x2359f57b108>]




![png](output_27_1.png)



```python
difference=testPredict-testclose_rs
```


```python
testopen=np.array(samsung['open'][-501:])
```


```python
testhigh=np.array(samsung['high'][-501:])
testlow=np.array(samsung['low'][-501:])
```


```python
Predict1dim=testPredict.reshape(1,-1)
Predictarray=Predict1dim[0]
Predictarray
```




    array([50174.676, 50873.09 , 52087.668, 51876.32 , 52183.625, 51433.42 ,
           51182.5  , 50756.9  , 51317.664, 51664.668, 49316.977, 49863.297,
           48396.1  , 49531.81 , 51085.875, 51722.42 , 51201.816, 52202.812,
           52106.863, 50543.67 , 49023.598, 48435.375, 48396.1  , 48729.723,
           50155.227, 49785.36 , 50057.973, 49492.77 , 48435.375, 49336.52 ,
           49512.293, 50407.824, 50911.8  , 51336.96 , 49960.66 , 50057.973,
           49980.137, 47904.402, 48120.906, 47628.504, 46025.043, 46223.645,
           44929.863, 45945.562, 47746.793, 49180.125, 48572.805, 47608.785,
           47490.414, 46976.688, 47431.207, 47589.06 , 47589.06 , 47273.223,
           46243.49 , 45428.28 , 47233.707, 48808.14 , 49375.594, 49902.246,
           49902.246, 51760.91 , 51857.09 , 51645.41 , 51259.746, 50873.09 ,
           51317.664, 51182.5  , 51876.32 , 49882.77 , 50427.24 , 50135.785,
           48886.51 , 49219.234, 49395.133, 48729.723, 48317.52 , 47134.895,
           48925.69 , 48592.42 , 49375.594, 49062.74 , 49043.168, 49180.125,
           49960.66 , 50485.465, 50135.785, 51471.99 , 52834.418, 51722.42 ,
           51991.633, 50601.85 , 50543.67 , 52221.996, 53044.305, 53044.305,
           53044.305, 53044.305, 51991.633, 52662.45 , 51027.875, 51703.176,
           51414.13 , 50252.43 , 49375.594, 50009.332, 49570.84 , 49668.38 ,
           50155.227, 51895.547, 51510.54 , 52758.02 , 52375.35 , 51414.13 ,
           49668.38 , 50834.375, 51414.13 , 51221.13 , 51414.13 , 50737.527,
           49814.586, 50057.973, 49570.84 , 48396.1  , 47855.164, 46818.367,
           47213.94 , 47213.94 , 47263.348, 47460.812, 46867.86 , 47213.945,
           48150.414, 47016.25 , 46867.86 , 45776.57 , 46372.47 , 46471.637,
           46174.004, 45129.35 , 45826.29 , 46521.2  , 46223.645, 45726.85 ,
           46719.36 , 46273.258, 46074.72 , 46768.867, 47115.125, 47658.086,
           46719.36 , 46372.47 , 46372.47 , 47115.125, 47115.125, 46719.36 ,
           46471.637, 46768.867, 45776.57 , 45975.37 , 46025.043, 46917.332,
           47016.25 , 47115.125, 45627.363, 45278.85 , 45378.48 , 44480.49 ,
           44330.527, 44080.42 , 45029.62 , 46322.87 , 46422.055, 46372.47 ,
           46521.2  , 46768.867, 47016.25 , 47855.164, 48641.47 , 47658.086,
           47855.164, 46818.367, 46322.87 , 45129.35 , 45726.85 , 45278.85 ,
           44780.16 , 44280.523, 46074.72 , 45378.48 , 45726.85 , 46372.47 ,
           47460.812, 47608.785, 47707.37 , 46669.836, 46570.758, 45925.688,
           44929.863, 44929.863, 45179.19 , 45527.84 , 43328.84 , 44230.51 ,
           44030.37 , 43830.105, 44380.523, 44280.523, 44130.46 , 43780.01 ,
           43278.67 , 42776.543, 41215.535, 41215.535, 41618.97 , 42575.49 ,
           42625.758, 42374.32 , 44380.523, 44030.37 , 43980.316, 44230.51 ,
           44280.523, 44530.457, 45428.28 , 44730.234, 44330.527, 44230.51 ,
           43880.188, 43027.7  , 42324.008, 42676.03 , 42625.758, 42826.793,
           43278.67 , 43379.004, 43379.004, 42072.355, 43479.3  , 42374.32 ,
           41669.37 , 40710.73 , 41165.082, 40407.598, 40458.13 , 40660.223,
           40205.402, 39142.7  , 39345.26 , 39092.05 , 39294.63 , 38838.746,
           38838.746, 38990.746, 38534.668, 38433.28 , 38889.418, 38940.08 ,
           37773.98 , 37621.773, 38940.08 , 38281.18 , 39800.793, 40003.133,
           40710.73 , 40255.957, 41316.434, 41669.37 , 42173.035, 42525.207,
           42977.484, 42374.32 , 42223.37 , 43278.67 , 44979.75 , 45278.85 ,
           45726.85 , 46620.305, 46372.47 , 46570.758, 46422.055, 45029.62 ,
           45229.027, 46273.258, 46422.055, 47707.37 , 46273.26 , 46422.055,
           46174.004, 47115.125, 47164.543, 47362.1  , 47559.477, 46966.797,
           46966.797, 45328.67 , 45079.49 , 44480.49 , 44230.51 , 44680.297,
           44030.37 , 43880.188, 44879.97 , 44080.42 , 44080.42 , 44430.504,
           43930.258, 44130.46 , 44280.523, 46074.72 , 46768.867, 45726.85 ,
           45478.06 , 45577.605, 45079.49 , 44879.97 , 45278.85 , 45975.37 ,
           46818.367, 47164.543, 47065.69 , 46867.86 , 46867.86 , 46917.332,
           46471.637, 47065.69 , 47263.348, 47460.812, 47263.348, 45826.29 ,
           45527.84 , 45577.605, 45428.28 , 44979.75 , 44879.97 , 45079.49 ,
           46372.47 , 46074.72 , 46124.363, 45527.84 , 45079.49 , 44480.49 ,
           42676.03 , 43128.113, 42877.035, 42877.035, 42776.543, 41770.152,
           41417.3  , 42223.37 , 43379.004, 43729.914, 44080.42 , 42927.26 ,
           42877.035, 42776.543, 42022.004, 42776.543, 42726.29 , 44030.37 ,
           43679.812, 44130.46 , 44430.504, 45029.62 , 45079.49 , 44830.066,
           43980.316, 44230.51 , 44130.46 , 44580.41 , 45577.605, 45726.85 ,
           45925.688, 45726.85 , 45826.29 , 45925.688, 46719.36 , 47213.945,
           46818.367, 46471.637, 45627.363, 46223.645, 45876.   , 44630.363,
           45328.67 , 45776.57 , 46422.055, 46521.2  , 46669.836, 47065.69 ,
           46273.258, 46322.87 , 47016.25 , 47411.465, 47510.15 , 46620.305,
           47411.465, 47362.1  , 46322.87 , 46768.867, 45577.605, 45428.28 ,
           45179.19 , 44180.49 , 43729.914, 43429.152, 42877.035, 43379.004,
           43930.258, 43228.492, 43930.258, 44130.46 , 43830.105, 44680.297,
           44730.234, 44280.523, 44180.49 , 43830.105, 44280.523, 44380.523,
           43629.7  , 44230.51 , 44030.37 , 43479.3  , 44330.527, 45925.688,
           46521.2  , 47115.125, 47213.945, 47362.1  , 47312.73 , 47115.125,
           47904.402, 49326.75 , 49375.594, 49473.25 , 49668.38 , 49082.312,
           49375.594, 48592.42 , 49229.016, 49033.387, 47805.91 , 48199.574,
           47953.633, 49082.312, 48739.535, 49326.746, 50155.227, 50252.43 ,
           50834.375, 50640.63 , 50057.973, 50446.65 , 51317.664, 51317.664,
           50834.375, 51027.875, 51414.13 , 51221.13 , 50543.67 , 50543.67 ,
           51317.664, 52375.35 , 52758.02 , 53329.98 , 52948.94 , 52183.625,
           51703.176, 52662.45 , 52566.82 , 53709.91 , 53520.082, 53520.082,
           52087.668, 51124.535, 51703.176, 51895.547, 51895.55 , 52279.52 ,
           51414.13 , 50446.65 , 50543.67 , 50057.973, 49619.617, 49668.38 ,
           50543.67 , 51317.664, 51606.887, 51991.633, 53329.98 , 54654.758,
           54654.758, 56522.137, 56151.12 , 55872.047, 55872.047, 55405.367,
           54936.793, 55311.797, 56336.797], dtype=float32)




```python
testopen_rs=testopen.reshape(-1,1)
```


```python
expected_profitday=[]
for day in range(len(testopen)):
    if testopen[day]>Predictarray[day] and testhigh[day]>Predictarray[day]:
        expected_profitday.append(day)
    elif testopen[day]<Predictarray[day] and testlow[day]<Predictarray[day]:
        expected_profitday.append(day)
    else:
        pass
```


```python
print("501일 동안 예상 수익 확률은 {}% 입니다".format(len(expected_profitday)/len(Predictarray)*100))
```

    501일 동안 예상 수익 확률은 82.03592814371258% 입니다
    


```python
expected_profitamount=[]
for day in range(len(testopen)):
    if testopen[day]>Predictarray[day] and testhigh[day]>Predictarray[day]:
        expected_profitamount.append(testopen[day]-Predictarray[day])
    elif testopen[day]<Predictarray[day] and testlow[day]<Predictarray[day]:
        expected_profitamount.append(Predictarray[day]-testopen[day])
    else:
        pass
```


```python
print("501일 동안 예상 수익은 {} 원입니다".format(sum(expected_profitamount)))
```

    501일 동안 예상 수익은 349445.78515625 원입니다
    


```python

```
