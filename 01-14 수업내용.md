```python
"""
정규화:0~1 사이의 범위로 데이터를 표준화
5 3 1 7 9 => 0~1 로 표시하고 싶음 =>  (해당 숫자x -최솟값1) / (최댓값9-최솟값1) 
"""
```


```python
*sklearn(사이킥런): 기계학습에 쓸 것이 많은 라이브러리
```


```python
import numpy as np
import pandas as pd
from sklearn.preprocessing import MinMaxScaler
```


```python
data=np.array([[10,-10,2],
              [5,0,6],
              [0,7,4]])
data
data.min()
```




    -10




```python
data.max()
```




    10




```python
data.max(axis=0)   #각 열 단위로 최댓값
```




    array([10,  7,  6])




```python
data.max(axis=1)  # 각 행 단위로 최댓값
```




    array([10,  6,  7])




```python
*분모:data.max(axis=0)-data.min(axis=0)
```




    array([10, 17,  4])




```python
*분자:data-data.min(axis=0)
```




    array([[10,  0,  0],
           [ 5, 10,  4],
           [ 0, 17,  2]])




```python
data_mm=(data-data.min(axis=0)) / (data.max(axis=0)-data.min(axis=0))
```




    array([[ 1.        , 10.        , -2.        ],
           [ 0.5       , 11.42857143, -1.33333333],
           [ 0.        , 12.42857143, -1.66666667]])




```python
mms=MinMaxScaler()
data_mms=mms.fit_transform(data)
data_mms
```




    array([[1.        , 0.        , 0.        ],
           [0.5       , 0.58823529, 1.        ],
           [0.        , 1.        , 0.5       ]])




```python
from sklearn.preprocessing import minmax_scale
```


```python
datamm=minmax_scale(data,axis=0)
datamm
```




    array([[1.        , 0.        , 0.        ],
           [0.5       , 0.58823529, 1.        ],
           [0.        , 1.        , 0.5       ]])




```python
*이항변수화: 연속형변수를 기준이하 -> 0, 기준초과 -> 1
확률변수 X가 이항분포를 따른다고 했을 때,0 또는 1 값을 갖는 이항변수화가 필요
```


```python
*베르누이 실행: 성공(1),실패(0) 두 가지 경우만 존재하는 경우
성공확률이 p인 베르누이 시행을 n번 수행.
성공하는 횟수를 x라고 하면, 
확률변수 x는 모수n과 p인 이항분포를 따른다
"""
주사위: 3이 나오면 성공,아니면 실패
p= 1/6
1-p= 5/6

A, B, C, D
(A만 성공,B만 성공, C만 성공, D만 성공)

A만 성공:1/6*(5/6)^3=0.0964
B만 성공:1/6*(5/6)^3=0.0964
C만 성공:1/6*(5/6)^3=0.0964
D만 성공:1/6*(5/6)^3=0.0964
=>
0.0964*4=0.3858
성공확률(p)*시나리오수(n)

"""
```


```python
from sklearn.preprocessing import Binarizer
```


```python
data=np.array([[10,-10,2],
              [5,0,6],
              [0,7,4]])
data
```


```python
bina=Binarizer(threshold=5).fit(data)   #threshold(5)이하=0, 이상=1
bina 
```




    Binarizer(copy=True, threshold=5)




```python
bina.transform(data)     
```




    array([[1, 0, 0],
           [0, 0, 1],
           [0, 1, 0]])




```python
bina=Binarizer(threshold=5.5).fit(data)   #threshold(5)이하=0, 이상=1
bina.transform(data)  
```




    array([[1, 0, 0],
           [0, 0, 1],
           [0, 1, 0]])




```python
from sklearn.preprocessing import binarize
```


```python
data=np.array([[10,-10,2],
              [5,0,6],
              [0,7,4]])
data
```




    array([[ 10, -10,   2],
           [  5,   0,   6],
           [  0,   7,   4]])




```python
binarize(data, threshold=5.9, copy=True)   #copy:True가 defalut
```




    array([[1, 0, 0],
           [0, 0, 1],
           [0, 1, 0]])




```python
binarize(data, threshold=5.9, copy=False) <- copy가 false면 원본으로 binarize를 하기 때문에 원본이 변함!!
```




    array([[1, 0, 0],
           [0, 0, 1],
           [0, 1, 0]])




```python
data
```




    array([[1, 0, 0],
           [0, 0, 1],
           [0, 1, 0]])




```python
*바이너라이저 : 연속형 변수를 이항변수화
*원핫인코더 : 범주형 변수를 이항변수화
"""
연령대:20대 -> 0, 30대 -> 1, 40대 -> 2
성별: 남->0, 여->1
학점: A=0, B=1, C=2, D=3, F=4

ex) 20대 여 B
=> 100 01 01000
30대 남 D
=> 010 10 00010

 *학점
01234
10000(A)
01000(B)
...
00001(F)
"""
```


```python
from sklearn.preprocessing import OneHotEncoder
```


```python
# [성별,연령,학점] 
data=np.array([[0,0,0],
              [0,1,1],
              [0,2,2],
              [1,0,3],
              [1,1,4]])
data
```




    array([[0, 0, 0],
           [0, 1, 1],
           [0, 2, 2],
           [1, 0, 3],
           [1, 1, 4]])




```python
ohe=OneHotEncoder()
ohe.fit(data)
```

    C:\Users\student\Anaconda3\lib\site-packages\sklearn\preprocessing\_encoders.py:415: FutureWarning: The handling of integer data will change in version 0.22. Currently, the categories are determined based on the range [0, max(values)], while in the future they will be determined based on the unique values.
    If you want the future behaviour and silence this warning, you can specify "categories='auto'".
    In case you used a LabelEncoder before this OneHotEncoder to convert the categories to integers, then you can now use the OneHotEncoder directly.
      warnings.warn(msg, FutureWarning)
    




    OneHotEncoder(categorical_features=None, categories=None, drop=None,
                  dtype=<class 'numpy.float64'>, handle_unknown='error',
                  n_values=None, sparse=True)




```python
ohe.active_features_
```

    C:\Users\student\Anaconda3\lib\site-packages\sklearn\utils\deprecation.py:100: DeprecationWarning: The ``active_features_`` attribute was deprecated in version 0.20 and will be removed 0.22.
      warnings.warn(msg, category=DeprecationWarning)
    




    array([0, 1, 2, 3, 4, 5, 6, 7, 8, 9], dtype=int64)




```python
ohe.n_values_
```

    C:\Users\student\Anaconda3\lib\site-packages\sklearn\utils\deprecation.py:100: DeprecationWarning: The ``n_values_`` attribute was deprecated in version 0.20 and will be removed 0.22.
      warnings.warn(msg, category=DeprecationWarning)
    




    array([2, 3, 5])




```python
ohe.feature_indices_
#성별:0~2
#연령:2~5
#학점:5~10
```

    C:\Users\student\Anaconda3\lib\site-packages\sklearn\utils\deprecation.py:100: DeprecationWarning: The ``feature_indices_`` attribute was deprecated in version 0.20 and will be removed 0.22.
      warnings.warn(msg, category=DeprecationWarning)
    




    array([ 0,  2,  5, 10], dtype=int32)




```python
#범주형 데이터 -> 이항변수화
data=np.array([[1,2,3]]) #여성 40대 C학점
ohe.transform(data).toarray()
```




    array([[0., 1., 0., 0., 1., 0., 0., 0., 1., 0.]])




```python
df = pd.DataFrame({'C1': np.random.randn(20),

   'C2': ['a', 'a', 'a', 'a', 'a', 'a', 'a', 'a', 'a', 'a',

   'b', 'b', 'b', 'b', 'b', 'b', 'b', 'b', 'b', 'b']})
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C1</th>
      <th>C2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.888609</td>
      <td>a</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.872228</td>
      <td>a</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.038080</td>
      <td>a</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2.061245</td>
      <td>a</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-2.055673</td>
      <td>a</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-1.446345</td>
      <td>a</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-0.061833</td>
      <td>a</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-0.097066</td>
      <td>a</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.655771</td>
      <td>a</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.078207</td>
      <td>a</td>
    </tr>
    <tr>
      <td>10</td>
      <td>1.029522</td>
      <td>b</td>
    </tr>
    <tr>
      <td>11</td>
      <td>-1.884994</td>
      <td>b</td>
    </tr>
    <tr>
      <td>12</td>
      <td>-0.131234</td>
      <td>b</td>
    </tr>
    <tr>
      <td>13</td>
      <td>-2.001769</td>
      <td>b</td>
    </tr>
    <tr>
      <td>14</td>
      <td>-1.420973</td>
      <td>b</td>
    </tr>
    <tr>
      <td>15</td>
      <td>-0.290236</td>
      <td>b</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.678828</td>
      <td>b</td>
    </tr>
    <tr>
      <td>17</td>
      <td>-0.579380</td>
      <td>b</td>
    </tr>
    <tr>
      <td>18</td>
      <td>-1.085970</td>
      <td>b</td>
    </tr>
    <tr>
      <td>19</td>
      <td>-0.161130</td>
      <td>b</td>
    </tr>
  </tbody>
</table>
</div>




```python
"""
np.digitize함수 or np.where함수: 연속형 변수 -> 이산화 
이항변수화: 0 또는 1 값을 갖는 변수를 만드는 것
이산화: 연속형 변수를 2개 이상의 범주를 갖는 변수로 변환하는 것
ex) 점수: 75 -> A/B/C/D/E/F(범수=category)
"""
np.random.seed(10)  # 42,777,1004
np.random.randn(1)
```




    array([1.3315865])




```python
"""
df의 c1열 20개 data 구성
10개 bin으로 균등하게 나눔
"""
```


```python
df.C1
```




    0    -0.888609
    1    -0.872228
    2     2.038080
    3     2.061245
    4    -2.055673
    5    -1.446345
    6    -0.061833
    7    -0.097066
    8     0.655771
    9     0.078207
    10    1.029522
    11   -1.884994
    12   -0.131234
    13   -2.001769
    14   -1.420973
    15   -0.290236
    16    0.678828
    17   -0.579380
    18   -1.085970
    19   -0.161130
    Name: C1, dtype: float64




```python
df.C1.min()
```




    -2.0556728403270426




```python
df.C1.max()
```




    2.0612445645223905




```python
bins=np.linspace(df.C1.min(),df.C1.max(),10)
bins
```




    array([-2.05567284, -1.59823757, -1.14080231, -0.68336704, -0.22593177,
            0.2315035 ,  0.68893876,  1.14637403,  1.6038093 ,  2.06124456])




```python
df.C1
df['C1_bin']=np.digitize(df['C1'],bins)
df       <-최댓값과 최솟값의 차이를 균등하게 나누었을 때 어떤 catagory에 들어가는지를 찾아줌
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C1</th>
      <th>C2</th>
      <th>C1_bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.888609</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.872228</td>
      <td>a</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.038080</td>
      <td>a</td>
      <td>9</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2.061245</td>
      <td>a</td>
      <td>10</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-2.055673</td>
      <td>a</td>
      <td>1</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-1.446345</td>
      <td>a</td>
      <td>2</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-0.061833</td>
      <td>a</td>
      <td>5</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-0.097066</td>
      <td>a</td>
      <td>5</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.655771</td>
      <td>a</td>
      <td>6</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.078207</td>
      <td>a</td>
      <td>5</td>
    </tr>
    <tr>
      <td>10</td>
      <td>1.029522</td>
      <td>b</td>
      <td>7</td>
    </tr>
    <tr>
      <td>11</td>
      <td>-1.884994</td>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <td>12</td>
      <td>-0.131234</td>
      <td>b</td>
      <td>5</td>
    </tr>
    <tr>
      <td>13</td>
      <td>-2.001769</td>
      <td>b</td>
      <td>1</td>
    </tr>
    <tr>
      <td>14</td>
      <td>-1.420973</td>
      <td>b</td>
      <td>2</td>
    </tr>
    <tr>
      <td>15</td>
      <td>-0.290236</td>
      <td>b</td>
      <td>4</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.678828</td>
      <td>b</td>
      <td>6</td>
    </tr>
    <tr>
      <td>17</td>
      <td>-0.579380</td>
      <td>b</td>
      <td>4</td>
    </tr>
    <tr>
      <td>18</td>
      <td>-1.085970</td>
      <td>b</td>
      <td>3</td>
    </tr>
    <tr>
      <td>19</td>
      <td>-0.161130</td>
      <td>b</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>




```python
#구간별로 요약통계, 범주간 평균 차이
#독립성검정, indexing...
df.groupby('C1_bin').size()    # <- group화를 하겠다, C1_bin의 크기가 얼마냐? 
df.groupby('C1_bin').mean()    # 각 group의 평균이 얼마냐?
df.groupby('C1_bin').std()     # 표준편차
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C1</th>
    </tr>
    <tr>
      <th>C1_bin</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>0.087248</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.017941</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.118958</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.204456</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.093157</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.016304</td>
    </tr>
    <tr>
      <td>7</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>9</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>10</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.groupby('C1_bin')['C2'].value_counts()   
(=>c1_bin으로 group화해라, c2를 참조해라)
  ex: index가1 에서 b값이 2개 a값이 1개 있다 는 의미
```




    C1_bin  C2
    1       b     2
            a     1
    2       a     1
            b     1
    3       a     2
            b     1
    4       b     2
    5       a     3
            b     2
    6       a     1
            b     1
    7       b     1
    9       a     1
    10      a     1
    Name: C2, dtype: int64




```python
df[df['C1_bin']==4]    C1_bin이 4인 경우만!!
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C1</th>
      <th>C2</th>
      <th>C1_bin</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>15</td>
      <td>-0.290236</td>
      <td>b</td>
      <td>4</td>
    </tr>
    <tr>
      <td>17</td>
      <td>-0.579380</td>
      <td>b</td>
      <td>4</td>
    </tr>
  </tbody>
</table>
</div>




```python
 #pd.get_dummies():가변수 생성
pd.get_dummies(df['C1_bin'])
=>모델=x1*가중치+x2*가중치+...+x10*가중치+바이어스
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>9</th>
      <th>10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>11</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>13</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.get_dummies(df['C1_bin'],prefix='C1')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C1_1</th>
      <th>C1_2</th>
      <th>C1_3</th>
      <th>C1_4</th>
      <th>C1_5</th>
      <th>C1_6</th>
      <th>C1_7</th>
      <th>C1_9</th>
      <th>C1_10</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
    </tr>
    <tr>
      <td>4</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>11</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>13</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>1</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
      <td>0</td>
    </tr>
  </tbody>
</table>
</div>




```python
np.where(조건,참,거짓)
```


```python
df['C1']>=df.C1.mean()
```




    0     False
    1     False
    2      True
    3      True
    4     False
    5     False
    6      True
    7      True
    8      True
    9      True
    10     True
    11    False
    12     True
    13    False
    14    False
    15     True
    16     True
    17    False
    18    False
    19     True
    Name: C1, dtype: bool




```python
df['h_l']=np.where(df['C1']>=df.C1.mean(),"high","low")
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>C1</th>
      <th>C2</th>
      <th>C1_bin</th>
      <th>h_l</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>-0.888609</td>
      <td>a</td>
      <td>3</td>
      <td>low</td>
    </tr>
    <tr>
      <td>1</td>
      <td>-0.872228</td>
      <td>a</td>
      <td>3</td>
      <td>low</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2.038080</td>
      <td>a</td>
      <td>9</td>
      <td>high</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2.061245</td>
      <td>a</td>
      <td>10</td>
      <td>high</td>
    </tr>
    <tr>
      <td>4</td>
      <td>-2.055673</td>
      <td>a</td>
      <td>1</td>
      <td>low</td>
    </tr>
    <tr>
      <td>5</td>
      <td>-1.446345</td>
      <td>a</td>
      <td>2</td>
      <td>low</td>
    </tr>
    <tr>
      <td>6</td>
      <td>-0.061833</td>
      <td>a</td>
      <td>5</td>
      <td>high</td>
    </tr>
    <tr>
      <td>7</td>
      <td>-0.097066</td>
      <td>a</td>
      <td>5</td>
      <td>high</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.655771</td>
      <td>a</td>
      <td>6</td>
      <td>high</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.078207</td>
      <td>a</td>
      <td>5</td>
      <td>high</td>
    </tr>
    <tr>
      <td>10</td>
      <td>1.029522</td>
      <td>b</td>
      <td>7</td>
      <td>high</td>
    </tr>
    <tr>
      <td>11</td>
      <td>-1.884994</td>
      <td>b</td>
      <td>1</td>
      <td>low</td>
    </tr>
    <tr>
      <td>12</td>
      <td>-0.131234</td>
      <td>b</td>
      <td>5</td>
      <td>high</td>
    </tr>
    <tr>
      <td>13</td>
      <td>-2.001769</td>
      <td>b</td>
      <td>1</td>
      <td>low</td>
    </tr>
    <tr>
      <td>14</td>
      <td>-1.420973</td>
      <td>b</td>
      <td>2</td>
      <td>low</td>
    </tr>
    <tr>
      <td>15</td>
      <td>-0.290236</td>
      <td>b</td>
      <td>4</td>
      <td>high</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.678828</td>
      <td>b</td>
      <td>6</td>
      <td>high</td>
    </tr>
    <tr>
      <td>17</td>
      <td>-0.579380</td>
      <td>b</td>
      <td>4</td>
      <td>low</td>
    </tr>
    <tr>
      <td>18</td>
      <td>-1.085970</td>
      <td>b</td>
      <td>3</td>
      <td>low</td>
    </tr>
    <tr>
      <td>19</td>
      <td>-0.161130</td>
      <td>b</td>
      <td>5</td>
      <td>high</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.groupby('h_l')    #groupby(기준 ) : group별로 나누어줌
df.groupby('h_l')['C1'].size()
```




    h_l
    high    11
    low      9
    Name: C1, dtype: int64




```python
df.groupby('h_l')['C1'].mean()
```




    h_l
    high    0.527287
    low    -1.359549
    Name: C1, dtype: float64




```python
df.groupby('h_l')['C1'].std()
```




    h_l
    high    0.862653
    low     0.539352
    Name: C1, dtype: float64




```python
q1=np.percentile(df['C1'],25)
q3=np.percentile(df['C1'],75)
#연습문제: C1열 값 <= Q1 then df['h_m_l']= l
#C1열 값 >Q1 and <=Q3 then df['h_m_l']= m
# else then df['h_m_l']= h
df['h_m_l']=np.where(df['C1']>=q3,"high",np.where(df['C1']>q1,"medium","low" ))
df['h_m_l']
```




    0     medium
    1     medium
    2       high
    3       high
    4        low
    5        low
    6     medium
    7     medium
    8       high
    9     medium
    10      high
    11       low
    12    medium
    13       low
    14       low
    15    medium
    16      high
    17    medium
    18    medium
    19    medium
    Name: h_m_l, dtype: object




```python
"""
데이터 재구조화
-피봇테이블(pivot,pivot_table)
-스택(stack,unstack)
-멜트(melt)
-wide_to_long,crosstab
"""
```


```python
data = pd.DataFrame({'cust_id': ['c1', 'c1', 'c1', 'c2', 'c2', 'c2', 'c3', 'c3', 'c3'],
'prod_cd': ['p1', 'p2', 'p3', 'p1', 'p2', 'p3', 'p1', 'p2', 'p3'],
'grade' : ['A', 'A', 'A', 'A', 'A', 'A', 'B', 'B', 'B'],
'pch_amt': [30, 10, 0, 40, 15, 30, 0, 0, 10]})
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_id</th>
      <th>prod_cd</th>
      <th>grade</th>
      <th>pch_amt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>c1</td>
      <td>p1</td>
      <td>A</td>
      <td>30</td>
    </tr>
    <tr>
      <td>1</td>
      <td>c1</td>
      <td>p2</td>
      <td>A</td>
      <td>10</td>
    </tr>
    <tr>
      <td>2</td>
      <td>c1</td>
      <td>p3</td>
      <td>A</td>
      <td>0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>c2</td>
      <td>p1</td>
      <td>A</td>
      <td>40</td>
    </tr>
    <tr>
      <td>4</td>
      <td>c2</td>
      <td>p2</td>
      <td>A</td>
      <td>15</td>
    </tr>
    <tr>
      <td>5</td>
      <td>c2</td>
      <td>p3</td>
      <td>A</td>
      <td>30</td>
    </tr>
    <tr>
      <td>6</td>
      <td>c3</td>
      <td>p1</td>
      <td>B</td>
      <td>0</td>
    </tr>
    <tr>
      <td>7</td>
      <td>c3</td>
      <td>p2</td>
      <td>B</td>
      <td>0</td>
    </tr>
    <tr>
      <td>8</td>
      <td>c3</td>
      <td>p3</td>
      <td>B</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




```python
*행에 c1,c2,c3 열에 p1,p2,p3 만들기!
```


```python
data.pivot(index='cust_id',columns='prod_cd',values='pch_amt')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>prod_cd</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
    </tr>
    <tr>
      <th>cust_id</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>c1</td>
      <td>30</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <td>c2</td>
      <td>40</td>
      <td>15</td>
      <td>30</td>
    </tr>
    <tr>
      <td>c3</td>
      <td>0</td>
      <td>0</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.pivot_table(data,index='cust_id',columns='prod_cd',values='pch_amt')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>prod_cd</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
    </tr>
    <tr>
      <th>cust_id</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>c1</td>
      <td>30</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <td>c2</td>
      <td>40</td>
      <td>15</td>
      <td>30</td>
    </tr>
    <tr>
      <td>c3</td>
      <td>0</td>
      <td>0</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




```python
*pivot으로 할 때 안되는 경우도 있지만 pivot_table은 모든게 다 잘 됨 
```


```python
data.pivot(index=['cust_id','grade'],columns='prod_cd',values='pch_amt')
*pivot으로 error나오는 예.
```


    ---------------------------------------------------------------------------

    ValueError                                Traceback (most recent call last)

    <ipython-input-94-01cdbb85f008> in <module>
    ----> 1 data.pivot(index=['cust_id','grade'],columns='prod_cd',values='pch_amt')
    

    ~\Anaconda3\lib\site-packages\pandas\core\frame.py in pivot(self, index, columns, values)
       5917         from pandas.core.reshape.pivot import pivot
       5918 
    -> 5919         return pivot(self, index=index, columns=columns, values=values)
       5920 
       5921     _shared_docs[
    

    ~\Anaconda3\lib\site-packages\pandas\core\reshape\pivot.py in pivot(data, index, columns, values)
        427             )
        428         else:
    --> 429             indexed = data._constructor_sliced(data[values].values, index=index)
        430     return indexed.unstack(columns)
        431 
    

    ~\Anaconda3\lib\site-packages\pandas\core\series.py in __init__(self, data, index, dtype, name, copy, fastpath)
        297                         raise ValueError(
        298                             "Length of passed values is {val}, "
    --> 299                             "index implies {ind}".format(val=len(data), ind=len(index))
        300                         )
        301                 except TypeError:
    

    ValueError: Length of passed values is 9, index implies 2



```python
pd.pivot_table(data,index=['cust_id','grade'],columns='prod_cd',values='pch_amt')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>prod_cd</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
    </tr>
    <tr>
      <th>cust_id</th>
      <th>grade</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>c1</td>
      <td>A</td>
      <td>30</td>
      <td>10</td>
      <td>0</td>
    </tr>
    <tr>
      <td>c2</td>
      <td>A</td>
      <td>40</td>
      <td>15</td>
      <td>30</td>
    </tr>
    <tr>
      <td>c3</td>
      <td>B</td>
      <td>0</td>
      <td>0</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.pivot_table(data,index='cust_id',columns=['prod_cd','grade'],values='pch_amt')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead tr th {
        text-align: left;
    }

    .dataframe thead tr:last-of-type th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr>
      <th>prod_cd</th>
      <th colspan="2" halign="left">p1</th>
      <th colspan="2" halign="left">p2</th>
      <th colspan="2" halign="left">p3</th>
    </tr>
    <tr>
      <th>grade</th>
      <th>A</th>
      <th>B</th>
      <th>A</th>
      <th>B</th>
      <th>A</th>
      <th>B</th>
    </tr>
    <tr>
      <th>cust_id</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>c1</td>
      <td>30.0</td>
      <td>NaN</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>c2</td>
      <td>40.0</td>
      <td>NaN</td>
      <td>15.0</td>
      <td>NaN</td>
      <td>30.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>c3</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>0.0</td>
      <td>NaN</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
*pivot_table: 집계함수 제공
```


```python
pd.pivot_table(data,index="grade",columns='prod_cd',values='pch_amt')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>prod_cd</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
    </tr>
    <tr>
      <th>grade</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>A</td>
      <td>35.0</td>
      <td>12.5</td>
      <td>15.0</td>
    </tr>
    <tr>
      <td>B</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.pivot_table(data,index="grade",columns='prod_cd',values='pch_amt',aggfunc=np.mean)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>prod_cd</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
    </tr>
    <tr>
      <th>grade</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>A</td>
      <td>35.0</td>
      <td>12.5</td>
      <td>15.0</td>
    </tr>
    <tr>
      <td>B</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>10.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.pivot_table(data,index="grade",columns='prod_cd',values='pch_amt',aggfunc=np.sum)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>prod_cd</th>
      <th>p1</th>
      <th>p2</th>
      <th>p3</th>
    </tr>
    <tr>
      <th>grade</th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>A</td>
      <td>70</td>
      <td>25</td>
      <td>30</td>
    </tr>
    <tr>
      <td>B</td>
      <td>0</td>
      <td>0</td>
      <td>10</td>
    </tr>
  </tbody>
</table>
</div>




```python
*stack():위에서 아래로 쌓는 것
unstack(): 쌓여 있는 것을 옆으로 늘여 놓는 것(왼->오)
```


```python
mul_index = pd.MultiIndex.from_tuples([('cust_1', '2020'), ('cust_1', '2021'),
   ('cust_2', '2020'), ('cust_2', '2021')])  
data = pd.DataFrame(data=np.arange(16).reshape(4, 4),
   index=mul_index,
   columns=['prd_1', 'prd_2', 'prd_3', 'prd_4'],
   dtype='int')
```


```python
mul_index
```




    MultiIndex([('cust_1', '2020'),
                ('cust_1', '2021'),
                ('cust_2', '2020'),
                ('cust_2', '2021')],
               )




```python
data
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>prd_1</th>
      <th>prd_2</th>
      <th>prd_3</th>
      <th>prd_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="2" valign="top">cust_1</td>
      <td>2020</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3</td>
    </tr>
    <tr>
      <td>2021</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7</td>
    </tr>
    <tr>
      <td rowspan="2" valign="top">cust_2</td>
      <td>2020</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>11</td>
    </tr>
    <tr>
      <td>2021</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>15</td>
    </tr>
  </tbody>
</table>
</div>




```python
datastd=data.stack()
datastd
```




    cust_1  2020  prd_1     0
                  prd_2     1
                  prd_3     2
                  prd_4     3
            2021  prd_1     4
                  prd_2     5
                  prd_3     6
                  prd_4     7
    cust_2  2020  prd_1     8
                  prd_2     9
                  prd_3    10
                  prd_4    11
            2021  prd_1    12
                  prd_2    13
                  prd_3    14
                  prd_4    15
    dtype: int32




```python
datastd.index
```




    MultiIndex([('cust_1', '2020', 'prd_1'),
                ('cust_1', '2020', 'prd_2'),
                ('cust_1', '2020', 'prd_3'),
                ('cust_1', '2020', 'prd_4'),
                ('cust_1', '2021', 'prd_1'),
                ('cust_1', '2021', 'prd_2'),
                ('cust_1', '2021', 'prd_3'),
                ('cust_1', '2021', 'prd_4'),
                ('cust_2', '2020', 'prd_1'),
                ('cust_2', '2020', 'prd_2'),
                ('cust_2', '2020', 'prd_3'),
                ('cust_2', '2020', 'prd_4'),
                ('cust_2', '2021', 'prd_1'),
                ('cust_2', '2021', 'prd_2'),
                ('cust_2', '2021', 'prd_3'),
                ('cust_2', '2021', 'prd_4')],
               )




```python
datastd['cust_2']   # 대분류 cuust_2가 나옴
```




    2020  prd_1     8
          prd_2     9
          prd_3    10
          prd_4    11
    2021  prd_1    12
          prd_2    13
          prd_3    14
          prd_4    15
    dtype: int32




```python
datastd['cust_2']['2020']   #중분류까지 나옴
```




    prd_1     8
    prd_2     9
    prd_3    10
    prd_4    11
    dtype: int32




```python
datastd['cust_2']['2020']['prd_1'] 
```




    8




```python
data.ix['cust_2','prd_4']=np.nan
data
```

    C:\Users\student\Anaconda3\lib\site-packages\ipykernel_launcher.py:1: FutureWarning: 
    .ix is deprecated. Please use
    .loc for label based indexing or
    .iloc for positional indexing
    
    See the documentation here:
    http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#ix-indexer-is-deprecated
      """Entry point for launching an IPython kernel.
    




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>prd_1</th>
      <th>prd_2</th>
      <th>prd_3</th>
      <th>prd_4</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td rowspan="2" valign="top">cust_1</td>
      <td>2020</td>
      <td>0</td>
      <td>1</td>
      <td>2</td>
      <td>3.0</td>
    </tr>
    <tr>
      <td>2021</td>
      <td>4</td>
      <td>5</td>
      <td>6</td>
      <td>7.0</td>
    </tr>
    <tr>
      <td rowspan="2" valign="top">cust_2</td>
      <td>2020</td>
      <td>8</td>
      <td>9</td>
      <td>10</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2021</td>
      <td>12</td>
      <td>13</td>
      <td>14</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
data.stack() <- NaN은 안나옴
```




    cust_1  2020  prd_1     0.0
                  prd_2     1.0
                  prd_3     2.0
                  prd_4     3.0
            2021  prd_1     4.0
                  prd_2     5.0
                  prd_3     6.0
                  prd_4     7.0
    cust_2  2020  prd_1     8.0
                  prd_2     9.0
                  prd_3    10.0
            2021  prd_1    12.0
                  prd_2    13.0
                  prd_3    14.0
    dtype: float64




```python
data.stack(dropna=False)   <- NaN은 나옴
```




    cust_1  2020  prd_1     0.0
                  prd_2     1.0
                  prd_3     2.0
                  prd_4     3.0
            2021  prd_1     4.0
                  prd_2     5.0
                  prd_3     6.0
                  prd_4     7.0
    cust_2  2020  prd_1     8.0
                  prd_2     9.0
                  prd_3    10.0
                  prd_4     NaN
            2021  prd_1    12.0
                  prd_2    13.0
                  prd_3    14.0
                  prd_4     NaN
    dtype: float64




```python
data1=pd.DataFrame({'cust_ID' : ['C_001', 'C_001', 'C_002', 'C_002'],
   'prd_CD' : ['P_001', 'P_002', 'P_001', 'P_002'],
   'pch_cnt' : [1, 2, 3, 4],
'pch_amt' : [100, 200, 300, 400]})
data1
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_ID</th>
      <th>prd_CD</th>
      <th>pch_cnt</th>
      <th>pch_amt</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>C_001</td>
      <td>P_001</td>
      <td>1</td>
      <td>100</td>
    </tr>
    <tr>
      <td>1</td>
      <td>C_001</td>
      <td>P_002</td>
      <td>2</td>
      <td>200</td>
    </tr>
    <tr>
      <td>2</td>
      <td>C_002</td>
      <td>P_001</td>
      <td>3</td>
      <td>300</td>
    </tr>
    <tr>
      <td>3</td>
      <td>C_002</td>
      <td>P_002</td>
      <td>4</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.melt(data1,id_vars=['cust_ID','prd_CD'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_ID</th>
      <th>prd_CD</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>C_001</td>
      <td>P_001</td>
      <td>pch_cnt</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>C_001</td>
      <td>P_002</td>
      <td>pch_cnt</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>C_002</td>
      <td>P_001</td>
      <td>pch_cnt</td>
      <td>3</td>
    </tr>
    <tr>
      <td>3</td>
      <td>C_002</td>
      <td>P_002</td>
      <td>pch_cnt</td>
      <td>4</td>
    </tr>
    <tr>
      <td>4</td>
      <td>C_001</td>
      <td>P_001</td>
      <td>pch_amt</td>
      <td>100</td>
    </tr>
    <tr>
      <td>5</td>
      <td>C_001</td>
      <td>P_002</td>
      <td>pch_amt</td>
      <td>200</td>
    </tr>
    <tr>
      <td>6</td>
      <td>C_002</td>
      <td>P_001</td>
      <td>pch_amt</td>
      <td>300</td>
    </tr>
    <tr>
      <td>7</td>
      <td>C_002</td>
      <td>P_002</td>
      <td>pch_amt</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.melt(data1,id_vars=['cust_ID','prd_CD'],var_name='CD',value_name='VAL')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>cust_ID</th>
      <th>prd_CD</th>
      <th>CD</th>
      <th>VAL</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>C_001</td>
      <td>P_001</td>
      <td>pch_cnt</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>C_001</td>
      <td>P_002</td>
      <td>pch_cnt</td>
      <td>2</td>
    </tr>
    <tr>
      <td>2</td>
      <td>C_002</td>
      <td>P_001</td>
      <td>pch_cnt</td>
      <td>3</td>
    </tr>
    <tr>
      <td>3</td>
      <td>C_002</td>
      <td>P_002</td>
      <td>pch_cnt</td>
      <td>4</td>
    </tr>
    <tr>
      <td>4</td>
      <td>C_001</td>
      <td>P_001</td>
      <td>pch_amt</td>
      <td>100</td>
    </tr>
    <tr>
      <td>5</td>
      <td>C_001</td>
      <td>P_002</td>
      <td>pch_amt</td>
      <td>200</td>
    </tr>
    <tr>
      <td>6</td>
      <td>C_002</td>
      <td>P_001</td>
      <td>pch_amt</td>
      <td>300</td>
    </tr>
    <tr>
      <td>7</td>
      <td>C_002</td>
      <td>P_002</td>
      <td>pch_amt</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
</div>




```python
pew=pd.read_csv("pew.csv")
pew.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>religion</th>
      <th>&lt;$10k</th>
      <th>$10-20k</th>
      <th>$20-30k</th>
      <th>$30-40k</th>
      <th>$40-50k</th>
      <th>$50-75k</th>
      <th>$75-100k</th>
      <th>$100-150k</th>
      <th>&gt;150k</th>
      <th>Don't know/refused</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Agnostic</td>
      <td>27</td>
      <td>34</td>
      <td>60</td>
      <td>81</td>
      <td>76</td>
      <td>137</td>
      <td>122</td>
      <td>109</td>
      <td>84</td>
      <td>96</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Atheist</td>
      <td>12</td>
      <td>27</td>
      <td>37</td>
      <td>52</td>
      <td>35</td>
      <td>70</td>
      <td>73</td>
      <td>59</td>
      <td>74</td>
      <td>76</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Buddhist</td>
      <td>27</td>
      <td>21</td>
      <td>30</td>
      <td>34</td>
      <td>33</td>
      <td>58</td>
      <td>62</td>
      <td>39</td>
      <td>53</td>
      <td>54</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Catholic</td>
      <td>418</td>
      <td>617</td>
      <td>732</td>
      <td>670</td>
      <td>638</td>
      <td>1116</td>
      <td>949</td>
      <td>792</td>
      <td>633</td>
      <td>1489</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Don’t know/refused</td>
      <td>15</td>
      <td>14</td>
      <td>15</td>
      <td>11</td>
      <td>10</td>
      <td>35</td>
      <td>21</td>
      <td>17</td>
      <td>18</td>
      <td>116</td>
    </tr>
  </tbody>
</table>
</div>




```python
pew.iloc[:,0:6]
#pd.melt(data1,id_vars=['cust_ID','prd_CD'],var_name='CD',value_name='VAL')
pd.melt(pew,id_vars=['<$10k','religion',])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>&lt;$10k</th>
      <th>religion</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>27</td>
      <td>Agnostic</td>
      <td>$10-20k</td>
      <td>34</td>
    </tr>
    <tr>
      <td>1</td>
      <td>12</td>
      <td>Atheist</td>
      <td>$10-20k</td>
      <td>27</td>
    </tr>
    <tr>
      <td>2</td>
      <td>27</td>
      <td>Buddhist</td>
      <td>$10-20k</td>
      <td>21</td>
    </tr>
    <tr>
      <td>3</td>
      <td>418</td>
      <td>Catholic</td>
      <td>$10-20k</td>
      <td>617</td>
    </tr>
    <tr>
      <td>4</td>
      <td>15</td>
      <td>Don’t know/refused</td>
      <td>$10-20k</td>
      <td>14</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>157</td>
      <td>13</td>
      <td>Orthodox</td>
      <td>Don't know/refused</td>
      <td>73</td>
    </tr>
    <tr>
      <td>158</td>
      <td>9</td>
      <td>Other Christian</td>
      <td>Don't know/refused</td>
      <td>18</td>
    </tr>
    <tr>
      <td>159</td>
      <td>20</td>
      <td>Other Faiths</td>
      <td>Don't know/refused</td>
      <td>71</td>
    </tr>
    <tr>
      <td>160</td>
      <td>5</td>
      <td>Other World Religions</td>
      <td>Don't know/refused</td>
      <td>8</td>
    </tr>
    <tr>
      <td>161</td>
      <td>217</td>
      <td>Unaffiliated</td>
      <td>Don't know/refused</td>
      <td>597</td>
    </tr>
  </tbody>
</table>
<p>162 rows × 4 columns</p>
</div>




```python
pd.melt(pew,id_vars=['religion'],var_name='income',value_name='count')
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>religion</th>
      <th>income</th>
      <th>count</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Agnostic</td>
      <td>&lt;$10k</td>
      <td>27</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Atheist</td>
      <td>&lt;$10k</td>
      <td>12</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Buddhist</td>
      <td>&lt;$10k</td>
      <td>27</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Catholic</td>
      <td>&lt;$10k</td>
      <td>418</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Don’t know/refused</td>
      <td>&lt;$10k</td>
      <td>15</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>175</td>
      <td>Orthodox</td>
      <td>Don't know/refused</td>
      <td>73</td>
    </tr>
    <tr>
      <td>176</td>
      <td>Other Christian</td>
      <td>Don't know/refused</td>
      <td>18</td>
    </tr>
    <tr>
      <td>177</td>
      <td>Other Faiths</td>
      <td>Don't know/refused</td>
      <td>71</td>
    </tr>
    <tr>
      <td>178</td>
      <td>Other World Religions</td>
      <td>Don't know/refused</td>
      <td>8</td>
    </tr>
    <tr>
      <td>179</td>
      <td>Unaffiliated</td>
      <td>Don't know/refused</td>
      <td>597</td>
    </tr>
  </tbody>
</table>
<p>180 rows × 3 columns</p>
</div>




```python
billboard=pd.read_csv("billboard.csv")
billboard
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>artist</th>
      <th>track</th>
      <th>time</th>
      <th>date.entered</th>
      <th>wk1</th>
      <th>wk2</th>
      <th>wk3</th>
      <th>wk4</th>
      <th>wk5</th>
      <th>...</th>
      <th>wk67</th>
      <th>wk68</th>
      <th>wk69</th>
      <th>wk70</th>
      <th>wk71</th>
      <th>wk72</th>
      <th>wk73</th>
      <th>wk74</th>
      <th>wk75</th>
      <th>wk76</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>4:22</td>
      <td>2000-02-26</td>
      <td>87</td>
      <td>82.0</td>
      <td>72.0</td>
      <td>77.0</td>
      <td>87.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2000</td>
      <td>2Ge+her</td>
      <td>The Hardest Part Of ...</td>
      <td>3:15</td>
      <td>2000-09-02</td>
      <td>91</td>
      <td>87.0</td>
      <td>92.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Kryptonite</td>
      <td>3:53</td>
      <td>2000-04-08</td>
      <td>81</td>
      <td>70.0</td>
      <td>68.0</td>
      <td>67.0</td>
      <td>66.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Loser</td>
      <td>4:24</td>
      <td>2000-10-21</td>
      <td>76</td>
      <td>76.0</td>
      <td>72.0</td>
      <td>69.0</td>
      <td>67.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2000</td>
      <td>504 Boyz</td>
      <td>Wobble Wobble</td>
      <td>3:35</td>
      <td>2000-04-15</td>
      <td>57</td>
      <td>34.0</td>
      <td>25.0</td>
      <td>17.0</td>
      <td>17.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>312</td>
      <td>2000</td>
      <td>Yankee Grey</td>
      <td>Another Nine Minutes</td>
      <td>3:10</td>
      <td>2000-04-29</td>
      <td>86</td>
      <td>83.0</td>
      <td>77.0</td>
      <td>74.0</td>
      <td>83.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>313</td>
      <td>2000</td>
      <td>Yearwood, Trisha</td>
      <td>Real Live Woman</td>
      <td>3:55</td>
      <td>2000-04-01</td>
      <td>85</td>
      <td>83.0</td>
      <td>83.0</td>
      <td>82.0</td>
      <td>81.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>314</td>
      <td>2000</td>
      <td>Ying Yang Twins</td>
      <td>Whistle While You Tw...</td>
      <td>4:19</td>
      <td>2000-03-18</td>
      <td>95</td>
      <td>94.0</td>
      <td>91.0</td>
      <td>85.0</td>
      <td>84.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>315</td>
      <td>2000</td>
      <td>Zombie Nation</td>
      <td>Kernkraft 400</td>
      <td>3:30</td>
      <td>2000-09-02</td>
      <td>99</td>
      <td>99.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>316</td>
      <td>2000</td>
      <td>matchbox twenty</td>
      <td>Bent</td>
      <td>4:12</td>
      <td>2000-04-29</td>
      <td>60</td>
      <td>37.0</td>
      <td>29.0</td>
      <td>24.0</td>
      <td>22.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>317 rows × 81 columns</p>
</div>




```python
pd.melt(pew,id_vars=['religion'],var_name='income',value_name='count')
pd.melt(billboard,id_vars=['year','artist','track','time','date.entered'])
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>year</th>
      <th>artist</th>
      <th>track</th>
      <th>time</th>
      <th>date.entered</th>
      <th>variable</th>
      <th>value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2000</td>
      <td>2 Pac</td>
      <td>Baby Don't Cry (Keep...</td>
      <td>4:22</td>
      <td>2000-02-26</td>
      <td>wk1</td>
      <td>87.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2000</td>
      <td>2Ge+her</td>
      <td>The Hardest Part Of ...</td>
      <td>3:15</td>
      <td>2000-09-02</td>
      <td>wk1</td>
      <td>91.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Kryptonite</td>
      <td>3:53</td>
      <td>2000-04-08</td>
      <td>wk1</td>
      <td>81.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>2000</td>
      <td>3 Doors Down</td>
      <td>Loser</td>
      <td>4:24</td>
      <td>2000-10-21</td>
      <td>wk1</td>
      <td>76.0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>2000</td>
      <td>504 Boyz</td>
      <td>Wobble Wobble</td>
      <td>3:35</td>
      <td>2000-04-15</td>
      <td>wk1</td>
      <td>57.0</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>24087</td>
      <td>2000</td>
      <td>Yankee Grey</td>
      <td>Another Nine Minutes</td>
      <td>3:10</td>
      <td>2000-04-29</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>24088</td>
      <td>2000</td>
      <td>Yearwood, Trisha</td>
      <td>Real Live Woman</td>
      <td>3:55</td>
      <td>2000-04-01</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>24089</td>
      <td>2000</td>
      <td>Ying Yang Twins</td>
      <td>Whistle While You Tw...</td>
      <td>4:19</td>
      <td>2000-03-18</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>24090</td>
      <td>2000</td>
      <td>Zombie Nation</td>
      <td>Kernkraft 400</td>
      <td>3:30</td>
      <td>2000-09-02</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>24091</td>
      <td>2000</td>
      <td>matchbox twenty</td>
      <td>Bent</td>
      <td>4:12</td>
      <td>2000-04-29</td>
      <td>wk76</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<p>24092 rows × 7 columns</p>
</div>




```python
s=pd.Series(range(10))
s[3]=np.nan
s
s.count()       <-데이터가 몇개 있는지 셀 수 있음
```




    9




```python
df=pd.DataFrame(np.random.randint(5, size=(4,4)), dtype=float)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.iloc[2,3]=np.nan
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.count()  <- 각 열의 데이터 갯수
```




    0    4
    1    4
    2    4
    3    3
    dtype: int64




```python
import seaborn as sns
titanic=sns.load_dataset("titanic")    <- seaborn에서 titanic을 제공해줌
titanic.head()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
    </tr>
  </tbody>
</table>
</div>




```python
titanic.count()
```




    survived       891
    pclass         891
    sex            891
    age            714
    sibsp          891
    parch          891
    fare           891
    embarked       889
    class          891
    who            891
    adult_male     891
    deck           203
    embark_town    889
    alive          891
    alone          891
    dtype: int64




```python
np.random.seed(777)
s2=pd.Series(np.random.randint(6, size=100))
s2
```




    0     3
    1     1
    2     5
    3     4
    4     1
         ..
    95    5
    96    3
    97    4
    98    5
    99    4
    Length: 100, dtype: int32




```python
s2.count()
```




    100




```python
s2.value_counts()    <- 각각의 데이터가 종류별로 count
```




    5    20
    0    20
    4    19
    3    15
    2    15
    1    11
    dtype: int64




```python
df[0].value_counts()    <- 열(series)단위로 value counts 해주면 됨
```




    1.0    2
    4.0    1
    2.0    1
    Name: 0, dtype: int64




```python
s2.value_counts().sort_index()   <-index를 기준으로 오름차순으로 정리되어 출력됨
```




    0    20
    1    11
    2    15
    3    15
    4    19
    5    20
    dtype: int64




```python
s.sort_values()    <- 값을 기준으로 정렬(nan은 맨 마지막)
s.sort_values(ascending=False)  <- 반대로 내림차순으로 정리해줌 그래도 nan은 맨 마지막
```




    9    9.0
    8    8.0
    7    7.0
    6    6.0
    5    5.0
    4    4.0
    2    2.0
    1    1.0
    0    0.0
    3    NaN
    dtype: float64




```python
df.sort_values(by=2) <- 2번 index 열을 기준으로 순서대로
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sort_values(by=[1,2])   <-1번 index로 나열해서 같으면 2번index열로 비교해서 나열해라
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sort_values(by=3)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>3.0</td>
      <td>1.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>2.0</td>
    </tr>
    <tr>
      <td>0</td>
      <td>2.0</td>
      <td>1.0</td>
      <td>0.0</td>
      <td>4.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>4.0</td>
      <td>1.0</td>
      <td>4.0</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
</div>




```python
df=pd.DataFrame(np.random.randint(10, size=(4,8)))
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>6</td>
      <td>6</td>
      <td>4</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>9</td>
    </tr>
    <tr>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>8</td>
      <td>5</td>
      <td>6</td>
    </tr>
    <tr>
      <td>3</td>
      <td>8</td>
      <td>7</td>
      <td>8</td>
      <td>0</td>
      <td>4</td>
      <td>8</td>
      <td>5</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
</div>




```python
df['Mysum']=df.sum(axis=1)
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>Mysum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>9</td>
      <td>0</td>
      <td>2</td>
      <td>3</td>
      <td>2</td>
      <td>6</td>
      <td>6</td>
      <td>4</td>
      <td>32</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2</td>
      <td>5</td>
      <td>3</td>
      <td>4</td>
      <td>3</td>
      <td>5</td>
      <td>0</td>
      <td>9</td>
      <td>31</td>
    </tr>
    <tr>
      <td>2</td>
      <td>5</td>
      <td>4</td>
      <td>0</td>
      <td>1</td>
      <td>3</td>
      <td>8</td>
      <td>5</td>
      <td>6</td>
      <td>32</td>
    </tr>
    <tr>
      <td>3</td>
      <td>8</td>
      <td>7</td>
      <td>8</td>
      <td>0</td>
      <td>4</td>
      <td>8</td>
      <td>5</td>
      <td>1</td>
      <td>41</td>
    </tr>
  </tbody>
</table>
</div>




```python
df.sum()
```




    0         24
    1         16
    2         13
    3          8
    4         12
    5         27
    6         16
    7         20
    Mysum    136
    dtype: int64




```python

df.loc['total',:]=df.sum()
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
      <th>3</th>
      <th>4</th>
      <th>5</th>
      <th>6</th>
      <th>7</th>
      <th>Mysum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>9.0</td>
      <td>0.0</td>
      <td>2.0</td>
      <td>3.0</td>
      <td>2.0</td>
      <td>6.0</td>
      <td>6.0</td>
      <td>4.0</td>
      <td>32.0</td>
    </tr>
    <tr>
      <td>1</td>
      <td>2.0</td>
      <td>5.0</td>
      <td>3.0</td>
      <td>4.0</td>
      <td>3.0</td>
      <td>5.0</td>
      <td>0.0</td>
      <td>9.0</td>
      <td>31.0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>5.0</td>
      <td>4.0</td>
      <td>0.0</td>
      <td>1.0</td>
      <td>3.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>6.0</td>
      <td>32.0</td>
    </tr>
    <tr>
      <td>3</td>
      <td>8.0</td>
      <td>7.0</td>
      <td>8.0</td>
      <td>0.0</td>
      <td>4.0</td>
      <td>8.0</td>
      <td>5.0</td>
      <td>1.0</td>
      <td>41.0</td>
    </tr>
    <tr>
      <td>total</td>
      <td>24.0</td>
      <td>16.0</td>
      <td>13.0</td>
      <td>8.0</td>
      <td>12.0</td>
      <td>27.0</td>
      <td>16.0</td>
      <td>20.0</td>
      <td>136.0</td>
    </tr>
  </tbody>
</table>
</div>




```python
*실수데이터를 카테고리화
cut(): 실수 값의 경계를 지정할 때 사용
qcut():똑같은 구간으로 나눔    
```


```python
ages=[0,2,10,21,23,37,31,61,20,42,32,100]
bins=[1,15,25,35,60,90]     
labels=["미성년자","청년","중년","장년","말년"]
cats=pd.cut(ages, bins, labels=labels)
cats.codes
```




    array([-1,  0,  0,  1,  1,  3,  2,  4,  1,  3,  2, -1], dtype=int8)




```python
df=pd.DataFrame(ages,columns=['ages'])
df['age_cat']=pd.cut(ages,bins,labels=labels)
```


```python
data=np.random.randn(100)
data
```




    array([ 0.70961996, -0.60025841,  0.99777366, -0.45900794,  0.18298863,
           -0.58434683,  1.07436428,  0.62100654,  1.02970471, -0.79996222,
           -0.4059395 ,  1.07999689,  1.57175215, -0.56380064,  1.02808698,
            0.90095174,  0.63244827,  0.10364945,  0.93120541, -1.30398263,
           -0.38172886,  1.25545909, -1.14495056,  0.04342658,  1.9973094 ,
           -0.08899967,  0.5053094 , -0.57107974,  0.27455132, -1.00214957,
           -0.17484469,  0.00645289,  0.04814084, -0.87471071,  0.05593493,
           -0.06400524, -0.46809165, -0.13647129, -1.64999084,  1.31129914,
           -1.10543099,  0.83489842,  2.62419329,  0.61094951,  0.61949192,
            1.77584112,  0.41833438,  0.06743435, -0.61218201, -0.54514375,
           -0.52881848,  0.7964861 ,  1.52190442, -0.30684183,  0.47500754,
           -0.58752868, -1.21289664,  0.12296897,  1.86864103, -0.24536327,
           -0.60208623, -0.20947121, -1.44508703, -0.0602464 , -0.51692898,
            0.42557717, -0.74667924, -1.59529304, -0.18719081, -0.66414793,
            1.82295114,  0.13400926,  1.06413341,  0.48661572, -0.72931696,
            0.72929889, -1.17448434,  1.48406999, -0.81304041,  0.10043507,
            0.60803666, -1.15479645,  0.44962076, -0.3998487 , -1.735746  ,
           -0.76104166,  0.6623826 ,  0.31350676,  0.02832225, -2.31951952,
            0.30827302, -0.55432599,  1.15579766,  0.50491764, -0.39735399,
            0.0399021 , -0.93591321,  0.04420941,  1.1399156 , -0.21048243])




```python
cats=pd.qcut(data,4,labels=['Q1','Q2','Q3','Q4'])
cats
```




    [Q4, Q1, Q4, Q2, Q3, ..., Q2, Q1, Q3, Q4, Q2]
    Length: 100
    Categories (4, object): [Q1 < Q2 < Q3 < Q4]




```python
pd.value_counts(cats)
```




    Q4    25
    Q3    25
    Q2    25
    Q1    25
    dtype: int64




```python

```
