```python
*연습문제 풀이
```


```python
스택(stack)이라는 자료구조를 생각해 보면 문제 풀이에 쉬움
```


```python
#자료형 처리
import pandas as pd
import seaborn as sns
```


```python
tips=sns.load_dataset("tips")
```


```python
tips.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 244 entries, 0 to 243
    Data columns (total 7 columns):
    total_bill    244 non-null float64
    tip           244 non-null float64
    sex           244 non-null category
    smoker        244 non-null category
    day           244 non-null category
    time          244 non-null category
    size          244 non-null int64
    dtypes: category(4), float64(2), int64(1)
    memory usage: 7.3 KB
    


```python
tips['sex_str']=tips['sex'].astype(str)
tips.dtypes
```




    total_bill     float64
    tip            float64
    sex           category
    smoker        category
    day           category
    time          category
    size             int64
    sex_str         object
    dtype: object




```python
tsm=tips.head(10)
tsm.loc[[1,3,5,7],'total_bill']='missing'
tsm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
      <th>sex_str</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>16.99</td>
      <td>1.01</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>Female</td>
    </tr>
    <tr>
      <td>1</td>
      <td>missing</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>2</td>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>3</td>
      <td>missing</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>4</td>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>Female</td>
    </tr>
    <tr>
      <td>5</td>
      <td>missing</td>
      <td>4.71</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>6</td>
      <td>8.77</td>
      <td>2.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>7</td>
      <td>missing</td>
      <td>3.12</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>8</td>
      <td>15.04</td>
      <td>1.96</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>9</td>
      <td>14.78</td>
      <td>3.23</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>Male</td>
    </tr>
  </tbody>
</table>
</div>




```python
tsm.dtypes
```




    total_bill      object
    tip            float64
    sex           category
    smoker        category
    day           category
    time          category
    size             int64
    sex_str         object
    dtype: object




```python
help(pow)
```

    Help on built-in function pow in module builtins:
    
    pow(x, y, z=None, /)
        Equivalent to x**y (with two arguments) or x**y % z (with three arguments)
        
        Some types, such as ints, are able to use a more efficient algorithm when
        invoked using the three argument form.
    
    


```python
tsm['total_bill'].astype(float)     <- error: missing이 문자라서 float으로 못바꿈
```


    ---------------------------------------------------------------------------

    ValueError                                Traceback (most recent call last)

    <ipython-input-15-559e20320701> in <module>
    ----> 1 tsm['total_bill'].astype(float)
    

    ~\Anaconda3\lib\site-packages\pandas\core\generic.py in astype(self, dtype, copy, errors, **kwargs)
       5880             # else, only a single dtype is given
       5881             new_data = self._data.astype(
    -> 5882                 dtype=dtype, copy=copy, errors=errors, **kwargs
       5883             )
       5884             return self._constructor(new_data).__finalize__(self)
    

    ~\Anaconda3\lib\site-packages\pandas\core\internals\managers.py in astype(self, dtype, **kwargs)
        579 
        580     def astype(self, dtype, **kwargs):
    --> 581         return self.apply("astype", dtype=dtype, **kwargs)
        582 
        583     def convert(self, **kwargs):
    

    ~\Anaconda3\lib\site-packages\pandas\core\internals\managers.py in apply(self, f, axes, filter, do_integrity_check, consolidate, **kwargs)
        436                     kwargs[k] = obj.reindex(b_items, axis=axis, copy=align_copy)
        437 
    --> 438             applied = getattr(b, f)(**kwargs)
        439             result_blocks = _extend_blocks(applied, result_blocks)
        440 
    

    ~\Anaconda3\lib\site-packages\pandas\core\internals\blocks.py in astype(self, dtype, copy, errors, values, **kwargs)
        557 
        558     def astype(self, dtype, copy=False, errors="raise", values=None, **kwargs):
    --> 559         return self._astype(dtype, copy=copy, errors=errors, values=values, **kwargs)
        560 
        561     def _astype(self, dtype, copy=False, errors="raise", values=None, **kwargs):
    

    ~\Anaconda3\lib\site-packages\pandas\core\internals\blocks.py in _astype(self, dtype, copy, errors, values, **kwargs)
        641                     # _astype_nansafe works fine with 1-d only
        642                     vals1d = values.ravel()
    --> 643                     values = astype_nansafe(vals1d, dtype, copy=True, **kwargs)
        644 
        645                 # TODO(extension)
    

    ~\Anaconda3\lib\site-packages\pandas\core\dtypes\cast.py in astype_nansafe(arr, dtype, copy, skipna)
        727     if copy or is_object_dtype(arr) or is_object_dtype(dtype):
        728         # Explicit copy, or required since NumPy can't view from / to object.
    --> 729         return arr.astype(dtype, copy=True)
        730 
        731     return arr.view(dtype)
    

    ValueError: could not convert string to float: 'missing'



```python
pd.to_numeric(tsm['total_bill'])   <- error: missing이 문자라서 숫자로 바꿔주지 못함
```


    ---------------------------------------------------------------------------

    ValueError                                Traceback (most recent call last)

    pandas\_libs\lib.pyx in pandas._libs.lib.maybe_convert_numeric()
    

    ValueError: Unable to parse string "missing"

    
    During handling of the above exception, another exception occurred:
    

    ValueError                                Traceback (most recent call last)

    <ipython-input-16-c9dcf45364b2> in <module>
    ----> 1 pd.to_numeric(tsm['total_bill'])
    

    ~\Anaconda3\lib\site-packages\pandas\core\tools\numeric.py in to_numeric(arg, errors, downcast)
        149             coerce_numeric = errors not in ("ignore", "raise")
        150             values = lib.maybe_convert_numeric(
    --> 151                 values, set(), coerce_numeric=coerce_numeric
        152             )
        153 
    

    pandas\_libs\lib.pyx in pandas._libs.lib.maybe_convert_numeric()
    

    ValueError: Unable to parse string "missing" at position 1



```python
tsm['total_bill']=pd.to_numeric(tsm['total_bill'],errors='ignore') <- errors조건을 'ignore'로 missing을 무시함
```

    C:\Users\student\Anaconda3\lib\site-packages\ipykernel_launcher.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      """Entry point for launching an IPython kernel.
    


```python
tsm.dtypes
```




    total_bill      object
    tip            float64
    sex           category
    smoker        category
    day           category
    time          category
    size             int64
    sex_str         object
    dtype: object




```python
tsm['total_bill']=pd.to_numeric(tsm['total_bill'],errors='coerce') <-'coerce': 숫자로 못 바꾸는 변수는 NaN으로
tsm.dtypes
```

    C:\Users\student\Anaconda3\lib\site-packages\ipykernel_launcher.py:1: SettingWithCopyWarning: 
    A value is trying to be set on a copy of a slice from a DataFrame.
    Try using .loc[row_indexer,col_indexer] = value instead
    
    See the caveats in the documentation: http://pandas.pydata.org/pandas-docs/stable/user_guide/indexing.html#returning-a-view-versus-a-copy
      """Entry point for launching an IPython kernel.
    




    total_bill     float64
    tip            float64
    sex           category
    smoker        category
    day           category
    time          category
    size             int64
    sex_str         object
    dtype: object




```python
tsm
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>total_bill</th>
      <th>tip</th>
      <th>sex</th>
      <th>smoker</th>
      <th>day</th>
      <th>time</th>
      <th>size</th>
      <th>sex_str</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>16.99</td>
      <td>1.01</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>Female</td>
    </tr>
    <tr>
      <td>1</td>
      <td>NaN</td>
      <td>1.66</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>2</td>
      <td>21.01</td>
      <td>3.50</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>3</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>3</td>
      <td>NaN</td>
      <td>3.31</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>4</td>
      <td>24.59</td>
      <td>3.61</td>
      <td>Female</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>Female</td>
    </tr>
    <tr>
      <td>5</td>
      <td>NaN</td>
      <td>4.71</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>6</td>
      <td>8.77</td>
      <td>2.00</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>7</td>
      <td>NaN</td>
      <td>3.12</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>4</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>8</td>
      <td>15.04</td>
      <td>1.96</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>Male</td>
    </tr>
    <tr>
      <td>9</td>
      <td>14.78</td>
      <td>3.23</td>
      <td>Male</td>
      <td>No</td>
      <td>Sun</td>
      <td>Dinner</td>
      <td>2</td>
      <td>Male</td>
    </tr>
  </tbody>
</table>
</div>




```python
tsm['total_bill']=pd.to_numeric(tsm['total_bill'],errors='raise') <-'raise'가 원래 default값임,
tsm                                                                    숫자 아닌경우가 있어서 error.
```


    ---------------------------------------------------------------------------

    ValueError                                Traceback (most recent call last)

    pandas\_libs\lib.pyx in pandas._libs.lib.maybe_convert_numeric()
    

    ValueError: Unable to parse string "missing"

    
    During handling of the above exception, another exception occurred:
    

    ValueError                                Traceback (most recent call last)

    <ipython-input-24-491ec72068c9> in <module>
    ----> 1 tsm['total_bill']=pd.to_numeric(tsm['total_bill'],errors='raise')
          2 tsm
    

    ~\Anaconda3\lib\site-packages\pandas\core\tools\numeric.py in to_numeric(arg, errors, downcast)
        149             coerce_numeric = errors not in ("ignore", "raise")
        150             values = lib.maybe_convert_numeric(
    --> 151                 values, set(), coerce_numeric=coerce_numeric
        152             )
        153 
    

    pandas\_libs\lib.pyx in pandas._libs.lib.maybe_convert_numeric()
    

    ValueError: Unable to parse string "missing" at position 1



```python
tips['sex']=tips['sex'].astype('str')
tips.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 244 entries, 0 to 243
    Data columns (total 8 columns):
    total_bill    244 non-null float64
    tip           244 non-null float64
    sex           244 non-null object
    smoker        244 non-null category
    day           244 non-null category
    time          244 non-null category
    size          244 non-null int64
    sex_str       244 non-null object
    dtypes: category(3), float64(2), int64(1), object(2)
    memory usage: 10.7+ KB
    


```python
tips['sex']=tips['sex'].astype('category')
tips.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 244 entries, 0 to 243
    Data columns (total 8 columns):
    total_bill    244 non-null float64
    tip           244 non-null float64
    sex           244 non-null category
    smoker        244 non-null category
    day           244 non-null category
    time          244 non-null category
    size          244 non-null int64
    sex_str       244 non-null object
    dtypes: category(4), float64(2), int64(1), object(1)
    memory usage: 9.2+ KB
    


```python
word='hello'
sent='world'
sent[-1]
sent[0:3]
sent[2:-1]  <- 2번째의 바로 앞에것 까지
```




    'rl'




```python
word[::2]
```




    'hlo'




```python
'Hello World'.capitalize()  <- 첫 글자를 대문자로 나머진 소문자
```




    'Hello world'




```python
"Hello World".count('o')   <- 'o'가 몇 글자?
```




    2




```python
"Hello World".startswith('Hello')  <- ~~으로 시작하냐?
```




    True




```python
'Hello World'.endswith('World')
"Hello World".find('l')  <- l 이 가장먼저 몇번 index에?
```




    2




```python
"Hello World".index('l')
"Hello World".find('p')   # <- 못 찾으면 -1
"Hello World".index('p')  <- 못 찾으면 error
```




    -1




```python
"Hello World".isalpha()  <- False: 공백이 있어서 True: 알파벳으로만 이루어지면
```




    True




```python
"130".isdecimal()
"I'm 25".isdecimal()
```




    False




```python
"Hello World".lower()
"Hello World".upper()
```




    'HELLO WORLD'




```python
"Hello World".replace("Hello","Hi")
" Hello World ".strip()   <- 양 끝에 공백을 제거하는 함수
```




    'Hello World'




```python
"Hi Hi Hi".split(sep=" ")    <-공백문자로 구분
```




    ['Hi', 'Hi', 'Hi']




```python
"9".zfill(with=5)
```


      File "<ipython-input-55-d9a4e956161e>", line 1
        "9".zfill(with=5)
                     ^
    SyntaxError: invalid syntax
    



```python
*join:문자열 연결
```


```python
d1='40'
d2='50'
d3='60'
d4='Number'
" ".join([d1,d2,d3,d4])   <- ( ) 안에 있는 애들을 join 앞에 있는 ""로 연결해라
```




    '40 50 60 Number'




```python
*splitlines: 여러 줄로 구성된 문자열을 분리
```


```python
mystr="""
A:Hello
B:Hi
A:How are you?
B:Fine
"""
msr=mystr.splitlines()
msr
msr2=msr[::2]
```


```python
msr2
```




    ['', 'B:Hi', 'B:Fine']




```python
msr2.replace("B:Hi","").splitlines()
```


    ---------------------------------------------------------------------------

    AttributeError                            Traceback (most recent call last)

    <ipython-input-62-e95da6bfc1c0> in <module>
    ----> 1 msr2.replace("B:Hi","").splitlines()
    

    AttributeError: 'list' object has no attribute 'replace'



```python
a='hi'
s='hello {}'
s.format(a)
```




    'hello hi'




```python
myhome='location:{lat},{lon}'
myhome.format(lat="36",lon='125')
```




    'location:36,125'




```python
s='%d digits of pi' % 3
s
```




    '3 digits of pi'




```python
print("some digits of %(co)s: %(val).2f" % {'co':'e','val':2.718})
```

    some digits of e: 2.72
    


```python
df=pd.DataFrame({"a":[1,2,3],"b":[2,3,4]})
```


```python
def my_sq(x):
    return x**2
def my_exp(x,n):
    return x**n
```


```python
df['a']**2
```




    0    1
    1    4
    2    9
    Name: a, dtype: int64




```python
df['a'].apply(my_sq)
```




    0    1
    1    4
    2    9
    Name: a, dtype: int64




```python
df['a'].apply(my_sq)
```




    0    1
    1    4
    2    9
    Name: a, dtype: int64




```python
df['a'].apply(my_exp,n=3)   <- 변수를 모두 지정해줘야 error안나옴
```




    0     1
    1     8
    2    27
    Name: a, dtype: int64




```python
def print_me(x):
    print(x)
df.apply(print_me,axis=1)
```

    a    1
    b    2
    Name: 0, dtype: int64
    a    2
    b    3
    Name: 1, dtype: int64
    a    3
    b    4
    Name: 2, dtype: int64
    




    0    None
    1    None
    2    None
    dtype: object




```python
def myavg(x,y,z):
    return (x+y+z)/3
def myavg_apply(data):
    x=data[0]
    y=data[1]
    z=data[2]
    return (x+y+z)/3
```


```python
df.apply(myavg_apply)
```




    a    2.0
    b    3.0
    dtype: float64




```python
def myavg_apply2(data):
    sum=0
    for item in data:
        sum+=item
    return sum/data.shape[0]
```


```python
df.apply(myavg_apply2,axis=1)
```




    0    1.5
    1    2.5
    2    3.5
    dtype: float64




```python
titanic=sns.load_dataset('titanic')
titanic.info()                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 891 entries, 0 to 890
    Data columns (total 15 columns):
    survived       891 non-null int64
    pclass         891 non-null int64
    sex            891 non-null object
    age            714 non-null float64
    sibsp          891 non-null int64
    parch          891 non-null int64
    fare           891 non-null float64
    embarked       889 non-null object
    class          891 non-null category
    who            891 non-null object
    adult_male     891 non-null bool
    deck           203 non-null category
    embark_town    889 non-null object
    alive          891 non-null object
    alone          891 non-null bool
    dtypes: bool(2), category(2), float64(2), int64(4), object(5)
    memory usage: 80.6+ KB
    


```python
titanic.columns
```




    Index(['survived', 'pclass', 'sex', 'age', 'sibsp', 'parch', 'fare',
           'embarked', 'class', 'who', 'adult_male', 'deck', 'embark_town',
           'alive', 'alone'],
          dtype='object')




```python
import numpy as np
```


```python
def count_missing(vec):
    #누락값의 개수 리턴
    nv=pd.isnull(vec)
    nc=np.sum(nv)  #True:1 , False:0 으로 합을 구함
    return nc

def prop_missing(vec):
    #누락값의 비율
    num=vec.size
    miss=count_missing(vec)
    return miss/num

def prop_complete(vec):
    #실존값의 비율
    return 1-prop_missing(vec)
```


```python
cm=titanic.apply(count_missing)
print(cm)
print("="*50)
pm=titanic.apply(prop_missing)
print(pm)
print("="*50)
pcm=titanic.apply(prop_complete)
print(pcm)
```

    survived         0
    pclass           0
    sex              0
    age            177
    sibsp            0
    parch            0
    fare             0
    embarked         2
    class            0
    who              0
    adult_male       0
    deck           688
    embark_town      2
    alive            0
    alone            0
    dtype: int64
    ==================================================
    survived       0.000000
    pclass         0.000000
    sex            0.000000
    age            0.198653
    sibsp          0.000000
    parch          0.000000
    fare           0.000000
    embarked       0.002245
    class          0.000000
    who            0.000000
    adult_male     0.000000
    deck           0.772166
    embark_town    0.002245
    alive          0.000000
    alone          0.000000
    dtype: float64
    ==================================================
    survived       1.000000
    pclass         1.000000
    sex            1.000000
    age            0.801347
    sibsp          1.000000
    parch          1.000000
    fare           1.000000
    embarked       0.997755
    class          1.000000
    who            1.000000
    adult_male     1.000000
    deck           0.227834
    embark_town    0.997755
    alive          1.000000
    alone          1.000000
    dtype: float64
    


```python
#행 방향으로 누락값의 개수/비율 조사
cmr=titanic.apply(count_missing,axis=1)
pmr=titanic.apply(prop_missing,axis=1)

pcmr=titanic.apply(prop_complete,axis=1)
cmr.head()
pmr.head()
pcmr.head()
```




    0    0.933333
    1    1.000000
    2    0.933333
    3    1.000000
    4    0.933333
    dtype: float64




```python
titanic
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
      <th>num_missig</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>22.0</td>
      <td>1</td>
      <td>0</td>
      <td>7.2500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
      <td>1</td>
    </tr>
    <tr>
      <td>1</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>38.0</td>
      <td>1</td>
      <td>0</td>
      <td>71.2833</td>
      <td>C</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>False</td>
      <td>0</td>
    </tr>
    <tr>
      <td>2</td>
      <td>1</td>
      <td>3</td>
      <td>female</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.9250</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <td>3</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>35.0</td>
      <td>1</td>
      <td>0</td>
      <td>53.1000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>C</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>False</td>
      <td>0</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>35.0</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>886</td>
      <td>0</td>
      <td>2</td>
      <td>male</td>
      <td>27.0</td>
      <td>0</td>
      <td>0</td>
      <td>13.0000</td>
      <td>S</td>
      <td>Second</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
      <td>1</td>
    </tr>
    <tr>
      <td>887</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>19.0</td>
      <td>0</td>
      <td>0</td>
      <td>30.0000</td>
      <td>S</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>B</td>
      <td>Southampton</td>
      <td>yes</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>888</td>
      <td>0</td>
      <td>3</td>
      <td>female</td>
      <td>NaN</td>
      <td>1</td>
      <td>2</td>
      <td>23.4500</td>
      <td>S</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>False</td>
      <td>2</td>
    </tr>
    <tr>
      <td>889</td>
      <td>1</td>
      <td>1</td>
      <td>male</td>
      <td>26.0</td>
      <td>0</td>
      <td>0</td>
      <td>30.0000</td>
      <td>C</td>
      <td>First</td>
      <td>man</td>
      <td>True</td>
      <td>C</td>
      <td>Cherbourg</td>
      <td>yes</td>
      <td>True</td>
      <td>0</td>
    </tr>
    <tr>
      <td>890</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>32.0</td>
      <td>0</td>
      <td>0</td>
      <td>7.7500</td>
      <td>Q</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Queenstown</td>
      <td>no</td>
      <td>True</td>
      <td>1</td>
    </tr>
  </tbody>
</table>
<p>891 rows × 16 columns</p>
</div>




```python
#num missing값이 1보다 큰 행을 추출
titanic[titanic['num_missig']>1]
titanic.loc[titanic.num_missig>1].sample(10)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>survived</th>
      <th>pclass</th>
      <th>sex</th>
      <th>age</th>
      <th>sibsp</th>
      <th>parch</th>
      <th>fare</th>
      <th>embarked</th>
      <th>class</th>
      <th>who</th>
      <th>adult_male</th>
      <th>deck</th>
      <th>embark_town</th>
      <th>alive</th>
      <th>alone</th>
      <th>num_missig</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>613</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>7.7500</td>
      <td>Q</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Queenstown</td>
      <td>no</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <td>270</td>
      <td>0</td>
      <td>1</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>31.0000</td>
      <td>S</td>
      <td>First</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <td>511</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>8.4583</td>
      <td>Q</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Queenstown</td>
      <td>no</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <td>829</td>
      <td>1</td>
      <td>1</td>
      <td>female</td>
      <td>62.0</td>
      <td>0</td>
      <td>0</td>
      <td>80.0000</td>
      <td>NaN</td>
      <td>First</td>
      <td>woman</td>
      <td>False</td>
      <td>B</td>
      <td>NaN</td>
      <td>yes</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <td>45</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>8.0500</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <td>738</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>7.8958</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <td>502</td>
      <td>0</td>
      <td>3</td>
      <td>female</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>7.6292</td>
      <td>Q</td>
      <td>Third</td>
      <td>woman</td>
      <td>False</td>
      <td>NaN</td>
      <td>Queenstown</td>
      <td>no</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <td>601</td>
      <td>0</td>
      <td>3</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>7.8958</td>
      <td>S</td>
      <td>Third</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
      <td>2</td>
    </tr>
    <tr>
      <td>674</td>
      <td>0</td>
      <td>2</td>
      <td>male</td>
      <td>NaN</td>
      <td>0</td>
      <td>0</td>
      <td>0.0000</td>
      <td>S</td>
      <td>Second</td>
      <td>man</td>
      <td>True</td>
      <td>NaN</td>
      <td>Southampton</td>
      <td>no</td>
      <td>True</td>
      <td>2</td>
    </tr>
  </tbody>
</table>
</div>




```python
pd.read_csv('names/names/yob1880.txt')
names2010=pd.read_csv('names/names/yob2010.txt',names=['name','sex','births'])
```


```python
names2010
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>births</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Isabella</td>
      <td>F</td>
      <td>22731</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Sophia</td>
      <td>F</td>
      <td>20477</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Emma</td>
      <td>F</td>
      <td>17179</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Olivia</td>
      <td>F</td>
      <td>16860</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Ava</td>
      <td>F</td>
      <td>15300</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>33833</td>
      <td>Zymaire</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33834</td>
      <td>Zyonne</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33835</td>
      <td>Zyquarius</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33836</td>
      <td>Zyran</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33837</td>
      <td>Zzyzx</td>
      <td>M</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>33838 rows × 3 columns</p>
</div>




```python
names2010.shape[0]
names2010.info()
```

    <class 'pandas.core.frame.DataFrame'>
    RangeIndex: 33838 entries, 0 to 33837
    Data columns (total 3 columns):
    name      33838 non-null object
    sex       33838 non-null object
    births    33838 non-null int64
    dtypes: int64(1), object(2)
    memory usage: 793.2+ KB
    


```python
names2010.tail()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>births</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>33833</td>
      <td>Zymaire</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33834</td>
      <td>Zyonne</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33835</td>
      <td>Zyquarius</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33836</td>
      <td>Zyran</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33837</td>
      <td>Zzyzx</td>
      <td>M</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
</div>




```python
#성별 기준으로 births의 합계 출력
print(names2010[names2010['sex']=='M']['births'].sum())
print(names2010[names2010['sex']=='F']['births'].sum())
```

    1898382
    1759010
    


```python
names2010.groupby('sex')   <- 성별을 기준으로 group화
```




    <pandas.core.groupby.generic.DataFrameGroupBy object at 0x000001F167331588>




```python
names2010.groupby('sex').sum()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>births</th>
    </tr>
    <tr>
      <th>sex</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>F</td>
      <td>1759010</td>
    </tr>
    <tr>
      <td>M</td>
      <td>1898382</td>
    </tr>
  </tbody>
</table>
</div>




```python
names2010.groupby('sex').births.sum()
```




    sex
    F    1759010
    M    1898382
    Name: births, dtype: int64




```python
pd.DataFrame(names2010)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>births</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Isabella</td>
      <td>F</td>
      <td>22731</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Sophia</td>
      <td>F</td>
      <td>20477</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Emma</td>
      <td>F</td>
      <td>17179</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Olivia</td>
      <td>F</td>
      <td>16860</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Ava</td>
      <td>F</td>
      <td>15300</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>33833</td>
      <td>Zymaire</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33834</td>
      <td>Zyonne</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33835</td>
      <td>Zyquarius</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33836</td>
      <td>Zyran</td>
      <td>M</td>
      <td>5</td>
    </tr>
    <tr>
      <td>33837</td>
      <td>Zzyzx</td>
      <td>M</td>
      <td>5</td>
    </tr>
  </tbody>
</table>
<p>33838 rows × 3 columns</p>
</div>




```python

pieces=[]
for year in range(1880,2011):
    path='names/names/yob%d.txt' % year
    df=pd.read_csv(path,names=['name','sex','births'])
    df['year']=year
    pieces.append(df)
    
pd.concat(pieces)     #     <-모든 pieces의 데이터들을 합침
pd.concat(pieces).shape
```




    (1690784, 4)




```python
names=pd.concat(pieces,ignore_index=True)
```


```python
names.head(20)
names[:20]
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>births</th>
      <th>year</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Mary</td>
      <td>F</td>
      <td>7065</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Anna</td>
      <td>F</td>
      <td>2604</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Emma</td>
      <td>F</td>
      <td>2003</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Elizabeth</td>
      <td>F</td>
      <td>1939</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Minnie</td>
      <td>F</td>
      <td>1746</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Margaret</td>
      <td>F</td>
      <td>1578</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Ida</td>
      <td>F</td>
      <td>1472</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Alice</td>
      <td>F</td>
      <td>1414</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Bertha</td>
      <td>F</td>
      <td>1320</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>9</td>
      <td>Sarah</td>
      <td>F</td>
      <td>1288</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>10</td>
      <td>Annie</td>
      <td>F</td>
      <td>1258</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>11</td>
      <td>Clara</td>
      <td>F</td>
      <td>1226</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>12</td>
      <td>Ella</td>
      <td>F</td>
      <td>1156</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>13</td>
      <td>Florence</td>
      <td>F</td>
      <td>1063</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>14</td>
      <td>Cora</td>
      <td>F</td>
      <td>1045</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>15</td>
      <td>Martha</td>
      <td>F</td>
      <td>1040</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>16</td>
      <td>Laura</td>
      <td>F</td>
      <td>1012</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>17</td>
      <td>Nellie</td>
      <td>F</td>
      <td>995</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>18</td>
      <td>Grace</td>
      <td>F</td>
      <td>982</td>
      <td>1880</td>
    </tr>
    <tr>
      <td>19</td>
      <td>Carrie</td>
      <td>F</td>
      <td>949</td>
      <td>1880</td>
    </tr>
  </tbody>
</table>
</div>




```python
#births를 데이터, 행을 year, 열을 sex로 pivot_table만들기
names.pivot_table('births',index='year',columns='sex',aggfunc=np.sum)
total_births=pd.pivot_table(data=names, values='births',index='year',columns='sex',aggfunc=np.sum )
```


```python
total_births.tail()
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>sex</th>
      <th>F</th>
      <th>M</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>2006</td>
      <td>1896468</td>
      <td>2050234</td>
    </tr>
    <tr>
      <td>2007</td>
      <td>1916888</td>
      <td>2069242</td>
    </tr>
    <tr>
      <td>2008</td>
      <td>1883645</td>
      <td>2032310</td>
    </tr>
    <tr>
      <td>2009</td>
      <td>1827643</td>
      <td>1973359</td>
    </tr>
    <tr>
      <td>2010</td>
      <td>1759010</td>
      <td>1898382</td>
    </tr>
  </tbody>
</table>
</div>




```python
total_births.plot(title='Total births')
```




    <matplotlib.axes._subplots.AxesSubplot at 0x1f10370a848>




![png](output_74_1.png)



```python
*names에서 각각의 이름이 차지하는 비율
(1) group화 하기: year, sex로
    ex: Mary는 1880년에 태어난 여자아이들 중 비중이 얼마냐
```


```python

```


```python

```


```python
def add_prop(group):
    births=group.births.sum()
    group['prop']=group.births/births
    return group
    #print(group.births.sum())
names=names.groupby(['year','sex']).apply(add_prop)
print(names)
```

                  name sex  births  year      prop
    0             Mary   F    7065  1880  0.077643
    1             Anna   F    2604  1880  0.028618
    2             Emma   F    2003  1880  0.022013
    3        Elizabeth   F    1939  1880  0.021309
    4           Minnie   F    1746  1880  0.019188
    ...            ...  ..     ...   ...       ...
    1690779    Zymaire   M       5  2010  0.000003
    1690780     Zyonne   M       5  2010  0.000003
    1690781  Zyquarius   M       5  2010  0.000003
    1690782      Zyran   M       5  2010  0.000003
    1690783      Zzyzx   M       5  2010  0.000003
    
    [1690784 rows x 5 columns]
    


```python
names.head(20)
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>births</th>
      <th>year</th>
      <th>prop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Mary</td>
      <td>F</td>
      <td>7065</td>
      <td>1880</td>
      <td>0.077643</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Anna</td>
      <td>F</td>
      <td>2604</td>
      <td>1880</td>
      <td>0.028618</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Emma</td>
      <td>F</td>
      <td>2003</td>
      <td>1880</td>
      <td>0.022013</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Elizabeth</td>
      <td>F</td>
      <td>1939</td>
      <td>1880</td>
      <td>0.021309</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Minnie</td>
      <td>F</td>
      <td>1746</td>
      <td>1880</td>
      <td>0.019188</td>
    </tr>
    <tr>
      <td>5</td>
      <td>Margaret</td>
      <td>F</td>
      <td>1578</td>
      <td>1880</td>
      <td>0.017342</td>
    </tr>
    <tr>
      <td>6</td>
      <td>Ida</td>
      <td>F</td>
      <td>1472</td>
      <td>1880</td>
      <td>0.016177</td>
    </tr>
    <tr>
      <td>7</td>
      <td>Alice</td>
      <td>F</td>
      <td>1414</td>
      <td>1880</td>
      <td>0.015540</td>
    </tr>
    <tr>
      <td>8</td>
      <td>Bertha</td>
      <td>F</td>
      <td>1320</td>
      <td>1880</td>
      <td>0.014507</td>
    </tr>
    <tr>
      <td>9</td>
      <td>Sarah</td>
      <td>F</td>
      <td>1288</td>
      <td>1880</td>
      <td>0.014155</td>
    </tr>
    <tr>
      <td>10</td>
      <td>Annie</td>
      <td>F</td>
      <td>1258</td>
      <td>1880</td>
      <td>0.013825</td>
    </tr>
    <tr>
      <td>11</td>
      <td>Clara</td>
      <td>F</td>
      <td>1226</td>
      <td>1880</td>
      <td>0.013474</td>
    </tr>
    <tr>
      <td>12</td>
      <td>Ella</td>
      <td>F</td>
      <td>1156</td>
      <td>1880</td>
      <td>0.012704</td>
    </tr>
    <tr>
      <td>13</td>
      <td>Florence</td>
      <td>F</td>
      <td>1063</td>
      <td>1880</td>
      <td>0.011682</td>
    </tr>
    <tr>
      <td>14</td>
      <td>Cora</td>
      <td>F</td>
      <td>1045</td>
      <td>1880</td>
      <td>0.011484</td>
    </tr>
    <tr>
      <td>15</td>
      <td>Martha</td>
      <td>F</td>
      <td>1040</td>
      <td>1880</td>
      <td>0.011429</td>
    </tr>
    <tr>
      <td>16</td>
      <td>Laura</td>
      <td>F</td>
      <td>1012</td>
      <td>1880</td>
      <td>0.011122</td>
    </tr>
    <tr>
      <td>17</td>
      <td>Nellie</td>
      <td>F</td>
      <td>995</td>
      <td>1880</td>
      <td>0.010935</td>
    </tr>
    <tr>
      <td>18</td>
      <td>Grace</td>
      <td>F</td>
      <td>982</td>
      <td>1880</td>
      <td>0.010792</td>
    </tr>
    <tr>
      <td>19</td>
      <td>Carrie</td>
      <td>F</td>
      <td>949</td>
      <td>1880</td>
      <td>0.010429</td>
    </tr>
  </tbody>
</table>
</div>




```python
#목표 output:
     name sex births year prop
    0 Mary F  10000  1880 0.08
    1 ...
    ...
```


```python
np.allclose(names.groupby(['year','sex']).prop.sum(),1)   <- group화한 group에 대해서 다 더한게 1에 가깝냐?
```




    True




```python
#각 연도별, 성별에 따른 이름 빈도수가 가장 높은 이름을 1000씩 추출
def get_top1000(group):
    return group.sort_index(by='births',ascending=False)[:1000]
    # <- births를 기준으로 내림차순 정리
grouped=names.groupby(['year','sex'])
top1000=grouped.apply(get_top1000)
# group index 제거: year가 2번 들어가서 error나왔었음
top1000.reset_index(inplace=True,drop=True)
```

    C:\Users\student\Anaconda3\lib\site-packages\ipykernel_launcher.py:3: FutureWarning: by argument to sort_index is deprecated, please use .sort_values(by=...)
      This is separate from the ipykernel package so we can avoid doing imports until
    


```python
girls=top1000[top1000.sex=='F']
boys=top1000[top1000.sex=='M']
```


```python
df=boys[boys.year==2010]
df
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>births</th>
      <th>year</th>
      <th>prop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>260877</td>
      <td>Jacob</td>
      <td>M</td>
      <td>21875</td>
      <td>2010</td>
      <td>0.011523</td>
    </tr>
    <tr>
      <td>260878</td>
      <td>Ethan</td>
      <td>M</td>
      <td>17866</td>
      <td>2010</td>
      <td>0.009411</td>
    </tr>
    <tr>
      <td>260879</td>
      <td>Michael</td>
      <td>M</td>
      <td>17133</td>
      <td>2010</td>
      <td>0.009025</td>
    </tr>
    <tr>
      <td>260880</td>
      <td>Jayden</td>
      <td>M</td>
      <td>17030</td>
      <td>2010</td>
      <td>0.008971</td>
    </tr>
    <tr>
      <td>260881</td>
      <td>William</td>
      <td>M</td>
      <td>16870</td>
      <td>2010</td>
      <td>0.008887</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>261872</td>
      <td>Camilo</td>
      <td>M</td>
      <td>194</td>
      <td>2010</td>
      <td>0.000102</td>
    </tr>
    <tr>
      <td>261873</td>
      <td>Destin</td>
      <td>M</td>
      <td>194</td>
      <td>2010</td>
      <td>0.000102</td>
    </tr>
    <tr>
      <td>261874</td>
      <td>Jaquan</td>
      <td>M</td>
      <td>194</td>
      <td>2010</td>
      <td>0.000102</td>
    </tr>
    <tr>
      <td>261875</td>
      <td>Jaydan</td>
      <td>M</td>
      <td>194</td>
      <td>2010</td>
      <td>0.000102</td>
    </tr>
    <tr>
      <td>261876</td>
      <td>Maxton</td>
      <td>M</td>
      <td>193</td>
      <td>2010</td>
      <td>0.000102</td>
    </tr>
  </tbody>
</table>
<p>1000 rows × 5 columns</p>
</div>




```python
total_births=top1000.pivot_table('births',
                                 index='year',columns='name',aggfunc=sum)
total_births
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th>name</th>
      <th>Aaden</th>
      <th>Aaliyah</th>
      <th>Aarav</th>
      <th>Aaron</th>
      <th>Aarush</th>
      <th>Ab</th>
      <th>Abagail</th>
      <th>Abb</th>
      <th>Abbey</th>
      <th>Abbie</th>
      <th>...</th>
      <th>Zoa</th>
      <th>Zoe</th>
      <th>Zoey</th>
      <th>Zoie</th>
      <th>Zola</th>
      <th>Zollie</th>
      <th>Zona</th>
      <th>Zora</th>
      <th>Zula</th>
      <th>Zuri</th>
    </tr>
    <tr>
      <th>year</th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>1880</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>102.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>71.0</td>
      <td>...</td>
      <td>8.0</td>
      <td>23.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>7.0</td>
      <td>NaN</td>
      <td>8.0</td>
      <td>28.0</td>
      <td>27.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1881</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>94.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>81.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>22.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>21.0</td>
      <td>27.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1882</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>85.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>80.0</td>
      <td>...</td>
      <td>8.0</td>
      <td>25.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>9.0</td>
      <td>NaN</td>
      <td>17.0</td>
      <td>32.0</td>
      <td>21.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1883</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>105.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>79.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>23.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>10.0</td>
      <td>NaN</td>
      <td>11.0</td>
      <td>35.0</td>
      <td>25.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>1884</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>97.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>98.0</td>
      <td>...</td>
      <td>13.0</td>
      <td>31.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>14.0</td>
      <td>6.0</td>
      <td>8.0</td>
      <td>58.0</td>
      <td>27.0</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>2006</td>
      <td>NaN</td>
      <td>3737.0</td>
      <td>NaN</td>
      <td>8279.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>297.0</td>
      <td>NaN</td>
      <td>404.0</td>
      <td>440.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>5145.0</td>
      <td>2839.0</td>
      <td>530.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2007</td>
      <td>NaN</td>
      <td>3941.0</td>
      <td>NaN</td>
      <td>8914.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>313.0</td>
      <td>NaN</td>
      <td>349.0</td>
      <td>468.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>4925.0</td>
      <td>3028.0</td>
      <td>526.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2008</td>
      <td>955.0</td>
      <td>4028.0</td>
      <td>219.0</td>
      <td>8511.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>317.0</td>
      <td>NaN</td>
      <td>344.0</td>
      <td>400.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>4764.0</td>
      <td>3438.0</td>
      <td>492.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2009</td>
      <td>1265.0</td>
      <td>4352.0</td>
      <td>270.0</td>
      <td>7936.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>296.0</td>
      <td>NaN</td>
      <td>307.0</td>
      <td>369.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>5120.0</td>
      <td>3981.0</td>
      <td>496.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <td>2010</td>
      <td>448.0</td>
      <td>4628.0</td>
      <td>438.0</td>
      <td>7374.0</td>
      <td>226.0</td>
      <td>NaN</td>
      <td>277.0</td>
      <td>NaN</td>
      <td>295.0</td>
      <td>324.0</td>
      <td>...</td>
      <td>NaN</td>
      <td>6200.0</td>
      <td>5164.0</td>
      <td>504.0</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>258.0</td>
    </tr>
  </tbody>
</table>
<p>131 rows × 6868 columns</p>
</div>




```python
prop_cumsum=df.sort_index(by='prop',ascending=False).prop.cumsum()          #<- ascending을 False로 주면 내림차순
prop_cumsum[:10]
```

    C:\Users\student\Anaconda3\lib\site-packages\ipykernel_launcher.py:1: FutureWarning: by argument to sort_index is deprecated, please use .sort_values(by=...)
      """Entry point for launching an IPython kernel.
    




    260877    0.011523
    260878    0.020934
    260879    0.029959
    260880    0.038930
    260881    0.047817
    260882    0.056579
    260883    0.065155
    260884    0.073414
    260885    0.081528
    260886    0.089621
    Name: prop, dtype: float64




```python
prop_cumsum.values.searchsorted(0.5)        #searchsorted(): 누적합이 ()인 지점까지 이름의 종류갯수 
# -> 2010년에 남자 신생아 이름중에 상위 50%의 이름은 갯수가 116개 있다는 의미
```




    116




```python
def get_qc(group,q=0.5):
    group=group.sort_index(by='prop',ascending=False)
    return group.prop.cumsum().values.searchsorted(q)

res=top1000.groupby(['year','sex']).apply(get_qc)
res=res.unstack('sex')
#res 출력 
res.plot()
```

    C:\Users\student\Anaconda3\lib\site-packages\ipykernel_launcher.py:2: FutureWarning: by argument to sort_index is deprecated, please use .sort_values(by=...)
      
    




    <matplotlib.axes._subplots.AxesSubplot at 0x1f10eae8888>




![png](output_88_2.png)



```python
top1000
```




<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>name</th>
      <th>sex</th>
      <th>births</th>
      <th>year</th>
      <th>prop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>Mary</td>
      <td>F</td>
      <td>7065</td>
      <td>1880</td>
      <td>0.077643</td>
    </tr>
    <tr>
      <td>1</td>
      <td>Anna</td>
      <td>F</td>
      <td>2604</td>
      <td>1880</td>
      <td>0.028618</td>
    </tr>
    <tr>
      <td>2</td>
      <td>Emma</td>
      <td>F</td>
      <td>2003</td>
      <td>1880</td>
      <td>0.022013</td>
    </tr>
    <tr>
      <td>3</td>
      <td>Elizabeth</td>
      <td>F</td>
      <td>1939</td>
      <td>1880</td>
      <td>0.021309</td>
    </tr>
    <tr>
      <td>4</td>
      <td>Minnie</td>
      <td>F</td>
      <td>1746</td>
      <td>1880</td>
      <td>0.019188</td>
    </tr>
    <tr>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <td>261872</td>
      <td>Camilo</td>
      <td>M</td>
      <td>194</td>
      <td>2010</td>
      <td>0.000102</td>
    </tr>
    <tr>
      <td>261873</td>
      <td>Destin</td>
      <td>M</td>
      <td>194</td>
      <td>2010</td>
      <td>0.000102</td>
    </tr>
    <tr>
      <td>261874</td>
      <td>Jaquan</td>
      <td>M</td>
      <td>194</td>
      <td>2010</td>
      <td>0.000102</td>
    </tr>
    <tr>
      <td>261875</td>
      <td>Jaydan</td>
      <td>M</td>
      <td>194</td>
      <td>2010</td>
      <td>0.000102</td>
    </tr>
    <tr>
      <td>261876</td>
      <td>Maxton</td>
      <td>M</td>
      <td>193</td>
      <td>2010</td>
      <td>0.000102</td>
    </tr>
  </tbody>
</table>
<p>261877 rows × 5 columns</p>
</div>




```python

```
